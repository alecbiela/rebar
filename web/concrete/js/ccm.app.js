!function(s){e={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onNone:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!(t=65)},c=function(e,t){e=k(e);s(t).data("colorpicker").fields.eq(1).val(e.r).end().eq(2).val(e.g).end().eq(3).val(e.b).end()},a=function(e,t){s(t).data("colorpicker").fields.eq(4).val(e.h).end().eq(5).val(e.s).end().eq(6).val(e.b).end()},n=function(e,t){s(t).data("colorpicker").fields.eq(0).val(w(e)).end()},o=function(e,t){s(t).data("colorpicker").selector.css("backgroundColor","#"+w({h:e.h,s:100,b:100})),s(t).data("colorpicker").selectorIndic.css({left:parseInt(150*e.s/100,10),top:parseInt(150*(100-e.b)/100,10)})},l=function(e,t){s(t).data("colorpicker").hue.css("top",parseInt(150-150*e.h/360,10))},r=function(e,t){s(t).data("colorpicker").newColor.css("backgroundColor","#"+w(e))},i=function(e){var t,i=s(this).parent().parent();i.data("colorpicker")&&i.data("colorpicker").fields&&(0<this.parentNode.className.indexOf("_hex")?i.data("colorpicker").color=t=y($(this.value)):0<this.parentNode.className.indexOf("_hsb")?i.data("colorpicker").color=t=v({h:parseInt(i.data("colorpicker").fields.eq(4).val(),10),s:parseInt(i.data("colorpicker").fields.eq(5).val(),10),b:parseInt(i.data("colorpicker").fields.eq(6).val(),10)}):i.data("colorpicker").color=t=C(b({r:parseInt(i.data("colorpicker").fields.eq(1).val(),10),g:parseInt(i.data("colorpicker").fields.eq(2).val(),10),b:parseInt(i.data("colorpicker").fields.eq(3).val(),10)})),e&&(c(t,i.get(0)),n(t,i.get(0)),a(t,i.get(0))),o(t,i.get(0)),l(t,i.get(0)),r(t,i.get(0)),i.data("colorpicker").onChange.apply(i,[t,w(t),k(t)]))},d=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&i.apply(e.data.field.get(0),[!0]),!1},m=function(e){return i.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colorpicker_slider").find("input").focus(),s(document).unbind("mouseup",m),s(document).unbind("mousemove",d),!1},h=function(e){return i.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-e.data.y)))/150,10)).get(0),[e.data.preview]),!1},u=function(e){return c(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),n(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),s(document).unbind("mouseup",u),s(document).unbind("mousemove",h),!1},p=function(e){return i.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-e.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-e.data.pos.left))/150,10)).get(0),[e.data.preview]),!1},f=function(e){return c(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),n(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),s(document).unbind("mouseup",f),s(document).unbind("mousemove",p),!1},g=function(e){_(e.data.cal.get(0),e.target,e.data.cal.get(0))||(0!=e.data.cal.data("colorpicker").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),s(document).unbind("mousedown",g))},_=function(e,t,i){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var c=t.parentNode;c&&c!=i;){if(c==e)return!0;c=c.parentNode}return!1},v=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},b=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},$=function(e){var t=6-e.length;if(0<t){for(var i=[],c=0;c<t;c++)i.push("0");i.push(e),e=i.join("")}return e},y=function(e){return C(H(e))},C=function(e){var t={};return t.b=Math.max(Math.max(e.r,e.g),e.b),t.s=t.b<=0?0:Math.round(100*(t.b-Math.min(Math.min(e.r,e.g),e.b))/t.b),t.b=Math.round(t.b/255*100),e.r==e.g&&e.g==e.b?t.h=0:e.r>=e.g&&e.g>=e.b?t.h=60*(e.g-e.b)/(e.r-e.b):e.g>=e.r&&e.r>=e.b?t.h=60+60*(e.g-e.r)/(e.g-e.b):e.g>=e.b&&e.b>=e.r?t.h=120+60*(e.b-e.r)/(e.g-e.r):e.b>=e.g&&e.g>=e.r?t.h=180+60*(e.b-e.g)/(e.b-e.r):e.b>=e.r&&e.r>=e.g?t.h=240+60*(e.r-e.g)/(e.b-e.g):e.r>=e.b&&e.b>=e.g?t.h=300+60*(e.r-e.b)/(e.r-e.g):t.h=0,t.h=Math.round(t.h),t},k=function(e){var t,i={},c=Math.round(e.h),a=Math.round(255*e.s/100),e=Math.round(255*e.b/100);return 0==a?i.r=i.g=i.b=e:(e=c%60*((t=e)-(a=(255-a)*e/255))/60,(c=360==c?0:c)<60?(i.r=t,i.b=a,i.g=a+e):c<120?(i.g=t,i.b=a,i.r=t-e):c<180?(i.g=t,i.r=a,i.b=a+e):c<240?(i.b=t,i.r=a,i.g=t-e):c<300?(i.b=t,i.g=a,i.r=a+e):c<360?(i.r=t,i.g=a,i.b=t-e):(i.r=0,i.g=0,i.b=0)),{r:Math.round(i.r),g:Math.round(i.g),b:Math.round(i.b)}},I=function(e){var i=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return s.each(i,function(e,t){1==t.length&&(i[e]="0"+t)}),i.join("")},w=function(e){return I(k(e))};var t,e,c,a,n,o,l,r,i,d,m,h,u,p,f,g,_,v,b,$,y,C,k,I,w,D={init:function(t){if("string"==typeof(t=s.extend({},e,t||{})).color)t.color=y(t.color);else if(null!=t.color.r&&null!=t.color.g&&null!=t.color.b)t.color=C(t.color);else{if(null==t.color.h||null==t.color.s||null==t.color.b)return this;t.color=v(t.color)}return t.origColor=t.color,this.each(function(){var e;s(this).data("colorpickerId")||(e="collorpicker_"+parseInt(1e3*Math.random()),s(this).data("colorpickerId",e),e=s('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" class="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" class="text" maxlength="3" size="3" /><span></span></div><input type="button" class="colorpicker_none" name="none" value="x" /><input type="button" class="colorpicker_submit" name="save" value="Ok" /></div>').attr("id",e),t.flat?e.appendTo(this).show():e.appendTo(document.body),t.fields=e.find("input").bind("keydown",T).bind("change",i).bind("blur",A).bind("focus",O),e.find("span").bind("mousedown",M),t.selector=e.find("div.colorpicker_color").bind("mousedown",x),t.selectorIndic=t.selector.find("div div"),t.hue=e.find("div.colorpicker_hue div"),e.find("div.colorpicker_hue").bind("mousedown",P),t.newColor=e.find("div.colorpicker_new_color"),t.currentColor=e.find("div.colorpicker_current_color"),e.data("colorpicker",t),e.find("input.colorpicker_none").bind("click",E),e.find("input.colorpicker_submit").bind("click",L),c(t.color,e.get(0)),a(t.color,e.get(0)),n(t.color,e.get(0)),l(t.color,e.get(0)),o(t.color,e.get(0)),S(t.color,e.get(0)),r(t.color,e.get(0)),t.flat?e.css({position:"relative",display:"block"}):s(this).bind(t.eventName,j))})},showPicker:function(){return this.each(function(){s(this).data("colorpickerId")&&j.apply(this)})},hidePicker:function(){return this.each(function(){s(this).data("colorpickerId")&&s("#"+s(this).data("colorpickerId")).hide()})},setColor:function(t){if("string"==typeof t)t=y(t);else if(null!=t.r&&null!=t.g&&null!=t.b)t=C(t);else{if(null==t.h||null==t.s||null==t.b)return this;t=v(t)}return this.each(function(){var e;s(this).data("colorpickerId")&&((e=s("#"+s(this).data("colorpickerId"))).data("colorpicker").color=t,e.data("colorpicker").origColor=t,c(t,e.get(0)),a(t,e.get(0)),n(t,e.get(0)),l(t,e.get(0)),o(t,e.get(0)),S(t,e.get(0)),r(t,e.get(0)))})}};function S(e,t){s(t).data("colorpicker").currentColor.css("backgroundColor","#"+w(e))}function T(e){if(e=e.charCode||e.keyCode||-1,t<e&&e<=90||32==e)return!1;!0===s(this).parent().parent().data("colorpicker").livePreview&&i.apply(this)}function A(e){var t=s(this).parent().parent().data("colorpicker");t&&t.fields&&t.fields.parent().removeClass("colorpicker_focus")}function O(){t=0<this.parentNode.className.indexOf("_hex")?70:65;var e=s(this).parent().parent().data("colorpicker");e&&e.fields&&e.fields.parent().removeClass("colorpicker_focus"),s(this).parent().addClass("colorpicker_focus")}function M(e){var t=s(this).parent().find("input").focus(),e={el:s(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:e.pageY,field:t,val:parseInt(t.val(),10),preview:s(this).parent().parent().data("colorpicker").livePreview};s(document).bind("mouseup",e,m),s(document).bind("mousemove",e,d)}function P(e){var t={cal:s(this).parent(),y:s(this).offset().top};t.preview=t.cal.data("colorpicker").livePreview,s(document).bind("mouseup",t,u),s(document).bind("mousemove",t,h)}function x(e){var t={cal:s(this).parent(),pos:s(this).offset()};t.preview=t.cal.data("colorpicker").livePreview,s(document).bind("mouseup",t,f),s(document).bind("mousemove",t,p)}function L(e){var t=s(this).parent(),i=t.data("colorpicker").color;t.data("colorpicker").origColor=i,S(i,t.get(0)),s("#"+s(this).data("colorpickerId")),t.data("colorpicker").onSubmit(i,w(i),k(i),t)}function E(e){var t=s(this).parent();t.data("colorpicker").onNone(t),t.hide()}function j(e){var t=s("#"+s(this).data("colorpickerId")),i=(t.data("colorpicker").onBeforeShow.apply(this,[t.get(0)]),s(this).offset()),c=(c="CSS1Compat"==document.compatMode,{l:window.pageXOffset||(c?document.documentElement:document.body).scrollLeft,t:window.pageYOffset||(c?document.documentElement:document.body).scrollTop,w:window.innerWidth||(c?document.documentElement:document.body).clientWidth,h:window.innerHeight||(c?document.documentElement:document.body).clientHeight}),a=i.top+this.offsetHeight,i=i.left;return c.t+c.h<a+176&&(a-=this.offsetHeight+176),c.l+c.w<i+356&&(i-=356),t.css({left:i+"px",top:a+"px"}),0!=t.data("colorpicker").onShow.apply(this,[t.get(0)])&&t.show(),s(document).bind("mousedown",{cal:t},g),!1}function H(e){return{r:(e=parseInt(-1<e.indexOf("#")?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}}s.fn.extend({ColorPicker:D.init,ColorPickerHide:D.hide,ColorPickerShow:D.show,ColorPickerSetColor:D.setColor})}(jQuery),!function(m){m.fn.hoverIntent=function(e,t){function i(e){var t=jQuery.extend({},e),i=this;i.hoverIntent_t&&(i.hoverIntent_t=clearTimeout(i.hoverIntent_t)),"mouseenter"==e.type?(s=t.pageX,n=t.pageY,m(i).bind("mousemove",l),1!=i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){r(t,i)},o.interval))):(m(i).unbind("mousemove",l),1==i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){d(t,i)},o.timeout)))}var c,a,s,n,o={sensitivity:7,interval:100,timeout:0},o=m.extend(o,t?{over:e,out:t}:e),l=function(e){c=e.pageX,a=e.pageY},r=function(e,t){if(t.hoverIntent_t=clearTimeout(t.hoverIntent_t),Math.abs(s-c)+Math.abs(n-a)<o.sensitivity)return m(t).unbind("mousemove",l),t.hoverIntent_s=1,o.over.apply(t,[e]);s=c,n=a,t.hoverIntent_t=setTimeout(function(){r(e,t)},o.interval)},d=function(e,t){return t.hoverIntent_t=clearTimeout(t.hoverIntent_t),t.hoverIntent_s=0,o.out.apply(t,[e])};return this.bind("mouseenter",i).bind("mouseleave",i)}}(jQuery),!function(c){var e=null;c.fn.liveUpdate=function(e,t){return this.each(function(){new c.liveUpdate(this,e,t)})},c.liveUpdate=function(e,t,i){this.field=c(e),c(e).data("liveUpdate",this),this.list=c("#"+t),this.lutype="blocktypes",void 0!==i&&(this.lutype=i),0<this.list.length&&this.init()},c.liveUpdate.prototype={init:function(){var e=this;this.setupCache(),this.field.parents("form").submit(function(){return!1}),this.field.keyup(function(){e.filter()}),e.filter()},filter:function(){if(this.field.val()!=e){if(""==c.trim(this.field.val()))return void("blocktypes"==this.lutype?(this.list.children("li").addClass("ccm-block-type-available"),this.list.children("li").removeClass("ccm-block-type-selected")):"attributes"==this.lutype?(this.list.children("li").addClass("ccm-attribute-available"),this.list.children("li").removeClass("ccm-attribute-selected")):"stacks"==this.lutype?(this.list.children("li").addClass("ccm-stack-available"),this.list.children("li").removeClass("ccm-stack-selected")):"intelligent-search"==this.lutype?this.list.is(":visible")&&this.list.hide():this.list.children("li").show());"intelligent-search"!=this.lutype||2<this.field.val().length?this.displayResults(this.getScores(this.field.val().toLowerCase())):"intelligent-search"==this.lutype&&this.list.is(":visible")&&this.list.hide()}""==(e=this.field.val())&&"intelligent-search"==this.lutype&&this.list.is(":visible")&&this.list.hide()},setupCache:function(){var t=this,i=(this.cache=[],this.rows=[],this.lutype);this.list.find("li").each(function(){var e;"blocktypes"==i?t.cache.push(c(this).find("a.ccm-block-type-inner").html().toLowerCase()):"attributes"==i||"stacks"==i?(e=c(this).find("a,span").html().toLowerCase(),t.cache.push(e)):"fileset"==i?t.cache.push(c(this).find("label").html().toLowerCase()):"intelligent-search"==i&&(e=c(this).find("span").html())&&t.cache.push(e.toLowerCase()),t.rows.push(c(this))}),this.cache_length=this.cache.length},displayResults:function(e){var i=this;"blocktypes"==this.lutype?(this.list.children("li").removeClass("ccm-block-type-available"),this.list.children("li").removeClass("ccm-block-type-selected"),c.each(e,function(e,t){i.rows[t[1]].addClass("ccm-block-type-available")}),c(this.list.find("li.ccm-block-type-available")[0]).addClass("ccm-block-type-selected")):"attributes"==this.lutype?(this.list.children("li").removeClass("ccm-attribute-available"),this.list.children("li").removeClass("ccm-attribute-selected"),this.list.children("li").removeClass("ccm-item-selected"),c.each(e,function(e,t){i.rows[t[1]].addClass("ccm-attribute-available")}),this.list.children("li.item-select-list-header").removeClass("ccm-attribute-available"),c(this.list.find("li.ccm-attribute-available")[0]).addClass("ccm-item-selected")):"stacks"==this.lutype?(this.list.children("li").removeClass("ccm-stack-available"),this.list.children("li").removeClass("ccm-stack-selected"),this.list.children("li").removeClass("ccm-item-selected"),c.each(e,function(e,t){i.rows[t[1]].addClass("ccm-stack-available")}),this.list.children("li.item-select-list-header").removeClass("ccm-stack-available"),c(this.list.find("li.ccm-stack-available")[0]).addClass("ccm-item-selected")):"intelligent-search"==this.lutype?(this.list.is(":visible")||this.list.fadeIn(160,"easeOutExpo"),this.list.find(".ccm-intelligent-search-results-module-onsite").hide(),this.list.find("li").hide(),c.each(e,function(e,t){$li=i.rows[t[1]],.75<t[0]&&($li.parent().parent().is(":visible")||$li.parent().parent().show(),$li.show())}),this.list.find("li a").removeClass("ccm-intelligent-search-result-selected"),this.list.find("li:visible a:first").addClass("ccm-intelligent-search-result-selected")):(this.list.children("li").hide(),c.each(e,function(e,t){i.rows[t[1]].show()}))},getScores:function(e){for(var t=[],i=0;i<this.cache_length;i++){var c=this.cache[i].score(e);0<c&&t.push([c,i])}return t.sort(function(e,t){return t[0]-e[0]})}}}(jQuery),!function($){$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(e,t){this.defaults.type=e,this.defaults.name=t},get:function(elem,opts){var settings=$.extend({},this.defaults,opts),data=(settings.single.length||(settings.single="metadata"),$.data(elem,settings.single)),attr;if(!data){if(data="{}","class"==settings.type){var m=settings.cre.exec(elem.className);m&&(data=m[1])}else if("elem"==settings.type){if(!elem.getElementsByTagName)return;var e=elem.getElementsByTagName(settings.name);e.length&&(data=$.trim(e[0].innerHTML))}else{null!=elem.getAttribute&&(attr=elem.getAttribute(settings.name),attr)&&(data=attr)}data.indexOf("{")<0&&(data="{"+data+"}"),data=eval("("+data+")"),$.data(elem,settings.single,data)}return data}}}),$.fn.metadata=function(e){return $.metadata.get(this[0],e)}}(jQuery),!function(){function i(e,t){return function(){return e.apply(t,arguments)}}var g,c,a,s;function e(e,t){this.form_field=e,this.options=null!=t?t:{},this.set_default_values(),this.form_field_jq=g(this.form_field),this.is_multiple=this.form_field.multiple,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl"),this.default_text_default=this.form_field.multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.set_up_html(),this.register_observers(),this.form_field_jq.addClass("chzn-done")}s=this,(g=jQuery).fn.extend({chosen:function(t){return"msie"!==g.browser||"6.0"!==g.browser.version&&"7.0"!==g.browser.version?g(this).each(function(e){if(!g(this).hasClass("chzn-done"))return new c(this,t)}):this}}),e.prototype.set_default_values=function(){return this.click_test_action=i(function(e){return this.test_active_click(e)},this),this.activate_action=i(function(e){return this.activate_field(e)},this),this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.choices=0,this.results_none_found=this.options.no_results_text||"No results match"},e.prototype.set_up_html=function(){var e,t;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/(:|\.)/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default,t=g("<div />",{id:this.container_id,class:"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?t.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):t.html('<a href="javascript:void(0)" class="chzn-single"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(t),this.container=g("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),!this.is_multiple&&this.form_field.options.length<=this.disable_search_threshold&&this.container.addClass("chzn-container-single-nosearch"),this.dropdown=this.container.find("div.chzn-drop").first(),t=this.container.height(),e=this.f_width-a(this.dropdown),this.dropdown.css({width:e+"px",top:t+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),t=e-a(this.search_container)-a(this.search_field),this.search_field.css({width:t+"px"})),this.results_build(),this.set_tab_index()},e.prototype.register_observers=function(){if(this.container.mousedown(i(function(e){return this.container_mousedown(e)},this)),this.container.mouseup(i(function(e){return this.container_mouseup(e)},this)),this.container.mouseenter(i(function(e){return this.mouse_enter(e)},this)),this.container.mouseleave(i(function(e){return this.mouse_leave(e)},this)),this.search_results.mouseup(i(function(e){return this.search_results_mouseup(e)},this)),this.search_results.mouseover(i(function(e){return this.search_results_mouseover(e)},this)),this.search_results.mouseout(i(function(e){return this.search_results_mouseout(e)},this)),this.form_field_jq.bind("liszt:updated",i(function(e){return this.results_update_field(e)},this)),this.search_field.blur(i(function(e){return this.input_blur(e)},this)),this.search_field.keyup(i(function(e){return this.keyup_checker(e)},this)),this.search_field.keydown(i(function(e){return this.keydown_checker(e)},this)),this.is_multiple)return this.search_choices.click(i(function(e){return this.choices_click(e)},this)),this.search_field.focus(i(function(e){return this.input_focus(e)},this))},e.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq.attr("disabled"),this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field.attr("disabled",!0),this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field.attr("disabled",!1),this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},e.prototype.container_mousedown=function(e){var t;if(!this.is_disabled)return t=null!=e&&g(e.target).hasClass("search-choice-close"),e&&"mousedown"===e.type&&e.stopPropagation(),this.pending_destroy_click||t?this.pending_destroy_click=!1:(this.active_field?this.is_multiple||!e||g(e.target)!==this.selected_item&&!g(e.target).parents("a.chzn-single").length||(e.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),g(document).click(this.click_test_action),this.results_show()),this.activate_field())},e.prototype.container_mouseup=function(e){if("ABBR"===e.target.nodeName)return this.results_reset(e)},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(e){if(!this.active_field)return setTimeout(i(function(){return this.container_mousedown()},this),50)},e.prototype.input_blur=function(e){if(!this.mouse_on_container)return this.active_field=!1,setTimeout(i(function(){return this.blur_test()},this),100)},e.prototype.blur_test=function(e){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()},e.prototype.close_field=function(){return g(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},e.prototype.activate_field=function(){return this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},e.prototype.test_active_click=function(e){return g(e.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},e.prototype.results_build=function(){var e,t,i,c,a;new Date;for(this.parsing=!0,this.results_data=s.SelectParser.select_to_array(this.form_field),this.is_multiple&&0<this.choices?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||this.selected_item.find("span").text(this.default_text),e="",i=0,c=(a=this.results_data).length;i<c;i++)(t=a[i]).group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.find("span").text(t.text),this.allow_single_deselect)&&this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},e.prototype.result_add_group=function(e){return e.disabled?"":(e.dom_id=this.container_id+"_g_"+e.array_index,'<li id="'+e.dom_id+'" class="group-result">'+g("<div />").text(e.label).html()+"</li>")},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.result_do_highlight=function(e){var t,i,c;if(e.length)return this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),(e=parseInt(this.search_results.css("maxHeight"),10))+(c=this.search_results.scrollTop())<=(t=(i=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight())?this.search_results.scrollTop(0<t-e?t-e:0):i<c?this.search_results.scrollTop(i):void 0},e.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_show=function(){var e;return this.is_multiple||(this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected)),e=this.is_multiple?this.container.height():this.container.height()-1,this.dropdown.css({top:e+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},e.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},e.prototype.set_tab_index=function(e){var t;if(this.form_field_jq.attr("tabindex"))return t=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",t):(this.selected_item.attr("tabindex",t),this.search_field.attr("tabindex",-1))},e.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},e.prototype.search_results_mouseup=function(e){var t=g(e.target).hasClass("active-result")?g(e.target):g(e.target).parents(".active-result").first();if(t.length)return this.result_highlight=t,this.result_select(e)},e.prototype.search_results_mouseover=function(e){e=g(e.target).hasClass("active-result")?g(e.target):g(e.target).parents(".active-result").first();if(e)return this.result_do_highlight(e)},e.prototype.search_results_mouseout=function(e){if(g(e.target).hasClass("active-result"))return this.result_clear_highlight()},e.prototype.choices_click=function(e){if(e.preventDefault(),this.active_field&&!g(e.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()},e.prototype.choice_build=function(e){var t=this.container_id+"_c_"+e.array_index;return this.choices+=1,this.search_container.before('<li class="search-choice" id="'+t+'"><span>'+e.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+e.array_index+'"></a></li>'),g("#"+t).find("a").first().click(i(function(e){return this.choice_destroy_link_click(e)},this))},e.prototype.choice_destroy_link_click=function(e){return e.preventDefault(),this.is_disabled?e.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(g(e.target)))},e.prototype.choice_destroy=function(e){return--this.choices,this.show_search_field_default(),this.is_multiple&&0<this.choices&&this.search_field.val().length<1&&this.results_hide(),this.result_deselect(e.attr("rel")),e.parents("li").first().remove()},e.prototype.results_reset=function(e){if(this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.show_search_field_default(),g(e.target).remove(),this.form_field_jq.trigger("change"),this.active_field)return this.results_hide()},e.prototype.result_select=function(e){var t,i;if(this.result_highlight)return t=(i=this.result_highlight).attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(i):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=i),i.addClass("result-selected"),i=t.substr(t.lastIndexOf("_")+1),(t=this.results_data[i]).selected=!0,this.form_field.options[t.options_index].selected=!0,this.is_multiple?this.choice_build(t):(this.selected_item.find("span").first().text(t.text),this.allow_single_deselect&&this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')),e.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),this.form_field_jq.trigger("change"),this.search_field_scale()},e.prototype.result_activate=function(e){return e.addClass("active-result")},e.prototype.result_deactivate=function(e){return e.removeClass("active-result")},e.prototype.result_deselect=function(e){var t=this.results_data[e];return t.selected=!1,this.form_field.options[t.options_index].selected=!1,g("#"+this.container_id+"_o_"+e).removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change"),this.search_field_scale()},e.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.winnow_results=function(){var e,t,i,c,a,s,n,o,l,r,d,m,h,u,p,f;new Date;for(this.no_results_clear(),n=0,o=this.search_field.val()===this.default_text?"":g("<div/>").text(g.trim(this.search_field.val())).html(),a=new RegExp("^"+o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),d=new RegExp(o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),m=0,u=(f=this.results_data).length;m<u;m++)if(!(t=f[m]).disabled&&!t.empty)if(t.group)g("#"+t.dom_id).hide();else if(!this.is_multiple||!t.selected){if(e=!1,s=t.dom_id,a.test(t.html))e=!0,n+=1;else if((0<=t.html.indexOf(" ")||0===t.html.indexOf("["))&&(c=t.html.replace(/\[|\]/g,"").split(" ")).length)for(h=0,p=c.length;h<p;h++)i=c[h],a.test(i)&&(e=!0,n+=1);e?(r=o.length?(l=t.html.search(d),(r=t.html.substr(0,l+o.length)+"</em>"+t.html.substr(l+o.length)).substr(0,l)+"<em>"+r.substr(l)):t.html,g("#"+s).html!==r&&g("#"+s).html(r),this.result_activate(g("#"+s)),null!=t.group_array_index&&g("#"+this.results_data[t.group_array_index].dom_id).show()):(this.result_highlight&&s===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(g("#"+s)))}return n<1&&o.length?this.no_results(o):this.winnow_results_set_highlight()},e.prototype.winnow_results_clear=function(){var e,t,i,c,a;for(this.search_field.val(""),a=[],i=0,c=(t=this.search_results.find("li")).length;i<c;i++)e=t[i],e=g(e),a.push(e.hasClass("group-result")?e.show():this.is_multiple&&e.hasClass("result-selected")?void 0:this.result_activate(e));return a},e.prototype.winnow_results_set_highlight=function(){var e;if(!this.result_highlight&&null!=(e=((e=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?e:this.search_results.find(".active-result")).first()))return this.result_do_highlight(e)},e.prototype.no_results=function(e){var t=g('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');return t.find("span").first().html(e),this.search_results.append(t)},e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},e.prototype.keydown_arrow=function(){var e;if(this.result_highlight?this.results_showing&&(e=this.result_highlight.nextAll("li.active-result").first())&&this.result_do_highlight(e):(e=this.search_results.find("li.active-result").first())&&this.result_do_highlight(g(e)),!this.results_showing)return this.results_show()},e.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(e.first()):(0<this.choices&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},e.prototype.keydown_backstroke=function(){return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(this.pending_backstroke=this.search_container.siblings("li.search-choice").last(),this.pending_backstroke.addClass("search-choice-focus"))},e.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},e.prototype.keyup_checker=function(e){var t=null!=(t=e.which)?t:e.keyCode;switch(this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&0<this.choices)return this.keydown_backstroke();if(this.pending_backstroke)break;return this.result_clear_highlight(),this.results_search();case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:if(this.results_showing)return this.results_hide();break;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.keydown_checker=function(e){var t=null!=(t=e.which)?t:e.keyCode;switch(this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},e.prototype.search_field_scale=function(){var e,t,i,c,a,s,n;if(this.is_multiple){for(i="position:absolute; left: -1000px; top: -1000px; display:none;",s=a=0,n=(c=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"]).length;s<n;s++)i+=(t=c[s])+":"+this.search_field.css(t)+";";return(e=g("<div />",{style:i})).text(this.search_field.val()),g("body").append(e),a=e.width()+25,e.remove(),a>this.f_width-10&&(a=this.f_width-10),this.search_field.css({width:a+"px"}),e=this.container.height(),this.dropdown.css({top:e+"px"})}},e.prototype.generate_field_id=function(){var e=this.generate_random_id();return this.form_field.id=e},e.prototype.generate_random_id=function(){for(var e="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();0<g("#"+e).length;)e+=this.generate_random_char();return e},e.prototype.generate_random_char=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ",t=Math.floor(Math.random()*e.length);return e.substring(t,t+1)},c=e,a=function(e){return e.outerWidth()-e.width()},s.get_side_border_padding=a}.call(this),!function(){var n;function e(){this.options_index=0,this.parsed=[]}e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,c,a,s,n=this.parsed.length;for(this.parsed.push({array_index:n,group:!0,label:e.label,children:0,disabled:e.disabled}),s=[],i=0,c=(a=e.childNodes).length;i<c;i++)t=a[i],s.push(this.add_option(t,n,e.disabled));return s},e.prototype.add_option=function(e,t,i){if("OPTION"===e.nodeName)return""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:!0===i?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},(n=e).select_to_array=function(e){for(var t,i=new n,c=e.childNodes,a=0,s=c.length;a<s;a++)t=c[a],i.add_node(t);return i.parsed},this.SelectParser=n}.call(this);var ccm_totalAdvancedSearchFields=0,ccm_alLaunchType=new Array,ccm_alActiveAssetField="",ccm_alProcessorTarget="",ccm_alDebug=!1,ccm_uploadedFiles=(ccm_triggerSelectFile=function(e,t){null==t&&(t=ccm_alActiveAssetField);var i=$("#"+t+"-fm-selected");$("#"+t+"-fm-display").hide(),i.show(),i.load(CCM_TOOLS_PATH+"/files/selector_data?fID="+e+"&ccm_file_selected_field="+t,function(){i.attr("fID",e),i.attr("ccm-file-manager-can-view",i.children("div").attr("ccm-file-manager-can-view")),i.attr("ccm-file-manager-can-edit",i.children("div").attr("ccm-file-manager-can-edit")),i.attr("ccm-file-manager-can-admin",i.children("div").attr("ccm-file-manager-can-admin")),i.attr("ccm-file-manager-can-replace",i.children("div").attr("ccm-file-manager-can-replace")),i.attr("ccm-file-manager-instance",t),i.unbind("click.concrete"),i.on("click.concrete",function(e){e.stopPropagation(),ccm_alActivateMenu($(this),e)}),"function"==typeof ccm_triggerSelectFileComplete&&ccm_triggerSelectFileComplete(e,t)}),$("#"+t+"-fm-value").attr("value",e),ccm_alSetupFileProcessor()},ccm_alGetFileData=function(e,t){$.getJSON(CCM_TOOLS_PATH+"/files/get_data.php?fID="+e,function(e){t(e)})},ccm_clearFile=function(e,t){e.stopPropagation();var e=$("#"+t+"-fm-selected"),i=$("#"+t+"-fm-display");$("#"+t+"-fm-value").attr("value",0),e.hide(),i.show()},ccm_activateFileManager=function(t,i){ccm_alLaunchType[i]=t,ccm_alSetupSelectFiles(i),$(document).click(function(e){e.stopPropagation(),ccm_alSelectNone()}),ccm_setupAdvancedSearch(i),"DASHBOARD"==t&&$(".dialog-launch").dialog(),ccm_alSetupCheckboxes(i),ccm_alSetupFileProcessor(),ccm_alSetupSingleUploadForm(),$("form#ccm-"+i+"-advanced-search select[name=fssID]").change(function(){var e;"DASHBOARD"==t?window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/files/search?fssID="+$(this).val():(jQuery.fn.dialog.showLoader(),e=$("div#ccm-"+i+"-overlay-wrapper input[name=dialogAction]").val()+"&refreshDialog=1&fssID="+$(this).val(),$.get(e,function(e){jQuery.fn.dialog.hideLoader(),$("div#ccm-"+i+"-overlay-wrapper").html(e),$("div#ccm-"+i+"-overlay-wrapper a.dialog-launch").dialog()}))}),ccm_searchActivatePostFunction[i]=function(){ccm_alSetupCheckboxes(i),ccm_alSetupSelectFiles(i),ccm_alSetupSingleUploadForm()}},ccm_alSetupSingleUploadForm=function(){$(".ccm-file-manager-submit-single").submit(function(){$(this).attr("target",ccm_alProcessorTarget),ccm_alSubmitSingle($(this).get(0))})},ccm_activateFileSelectors=function(){$(".ccm-file-manager-launch").unbind(),$(".ccm-file-manager-launch").click(function(){ccm_alLaunchSelectorFileManager($(this).parent().attr("ccm-file-manager-field"))})},ccm_alLaunchSelectorFileManager=function(e){ccm_alActiveAssetField=e;var c="",t=$("#"+e+"-fm-display input.ccm-file-manager-filter");if(t.length){var a,s={};for(i=0;i<t.length;i++)(a=$(t[i]).attr("name"))in s||(s[a]=[]),s[a].push($(t[i]).attr("value"));for(a in s)1==s[a].length?c+="&"+a+"="+encodeURIComponent(s[a][0]):$.each(s[a],function(e,t){c+="&"+a+"[]="+encodeURIComponent(t)})}ccm_launchFileManager(c)},ccm_launchFileManager=function(e){$.fn.dialog.open({width:"90%",height:"70%",appendButtons:!0,modal:!1,href:CCM_TOOLS_PATH+"/files/search_dialog?ocID="+CCM_CID+"&search=1"+e,title:ccmi18n_filemanager.title})},ccm_launchFileSetPicker=function(e){$.fn.dialog.open({width:500,height:160,modal:!1,href:CCM_TOOLS_PATH+"/files/pick_set?oldFSID="+e,title:ccmi18n_filemanager.sets})},ccm_alSubmitSetsForm=function(t){ccm_deactivateSearchResults(t),jQuery.fn.dialog.showLoader(),$("#ccm-"+t+"-add-to-set-form").ajaxSubmit(function(e){jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.hideLoader(),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){$("#ccm-"+t+"-sets-search-wrapper").load(CCM_TOOLS_PATH+"/files/search_sets_reload",{searchInstance:t},function(){$(".chosen-select").chosen(ccmi18n_chosen),ccm_parseAdvancedSearchResponse(e,t)})})})},ccm_alSubmitPasswordForm=function(t){ccm_deactivateSearchResults(t),$("#ccm-"+t+"-password-form").ajaxSubmit(function(e){jQuery.fn.dialog.closeTop(),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)})})},ccm_alSubmitStorageForm=function(t){ccm_deactivateSearchResults(t),$("#ccm-"+t+"-storage-form").ajaxSubmit(function(e){jQuery.fn.dialog.closeTop(),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)})})},ccm_alSubmitPermissionsForm=function(t){ccm_deactivateSearchResults(t),$("#ccm-"+t+"-permissions-form").ajaxSubmit(function(e){jQuery.fn.dialog.closeTop(),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)})})},ccm_alSetupSetsForm=function(e){$("#fsAddToSearchName").liveUpdate("ccm-file-search-add-to-sets-list","fileset"),$(".ccm-file-set-add-cb a").each(function(){var t=$(this).attr("ccm-tri-state-startup");$(this).click(function(){var e=0;switch($(this).attr("ccm-tri-state-selected")){case"0":e="1"==t?"1":"2";break;case"1":e="2";break;case"2":e="0"}$(this).attr("ccm-tri-state-selected",e),$(this).parent().find("input").val(e),$(this).find("img").attr("src",CCM_IMAGE_PATH+"/checkbox_state_"+e+".png")})}),$("#ccm-"+e+"-add-to-set-form input[name=fsNew]").click(function(){$(this).prop("checked")||$("#ccm-"+e+"-add-to-set-form input[name=fsNewText]").val("")}),$("#ccm-"+e+"-add-to-set-form").submit(function(){return ccm_alSubmitSetsForm(e),!1})},ccm_alSetupPasswordForm=function(){$("#ccm-file-password-form").submit(function(){return ccm_alSubmitPasswordForm(),!1})},ccm_alRescanFiles=function(){var e=CCM_TOOLS_PATH+"/files/rescan?",t=arguments;for(i=0;i<t.length;i++)e+="fID[]="+t[i]+"&";$.fn.dialog.open({title:ccmi18n_filemanager.rescan,href:e,width:350,modal:!1,height:200,onClose:function(){1==t.length&&($("#ccm-file-properties-wrapper").html(""),jQuery.fn.dialog.showLoader(),$("#ccm-file-properties-wrapper").load(CCM_TOOLS_PATH+"/files/properties?fID="+t[0]+"&reload=1",!1,function(){jQuery.fn.dialog.hideLoader(),$(this).find(".dialog-launch").dialog()}))}})},ccm_alSelectPermissionsEntity=function(e,t,i){var c=$("#ccm-file-permissions-entity-base").html(),c=($("#ccm-file-permissions-entities-wrapper").append('<div class="ccm-file-permissions-entity">'+c+"</div>"),$(".ccm-file-permissions-entity")),c=c[c.length-1];$(c).find("h3 span").html(i),$(c).find("input[type=hidden]").val(e+"_"+t),$(c).find("select").each(function(){$(this).attr("name",$(this).attr("name")+"_"+e+"_"+t)}),$(c).find("div.ccm-file-access-extensions input[type=checkbox]").each(function(){$(this).attr("name",$(this).attr("name")+"_"+e+"_"+t+"[]")}),ccm_alActivateFilePermissionsSelector()},ccm_alActivateFilePermissionsSelector=function(){$(".ccm-file-access-add select").unbind(),$(".ccm-file-access-add select").change(function(){var e=$(this).parents("div.ccm-file-permissions-entity")[0];$(this).val()==ccmi18n_filemanager.PTYPE_CUSTOM?$(e).find("div.ccm-file-access-add-extensions").show():$(e).find("div.ccm-file-access-add-extensions").hide()}),$(".ccm-file-access-file-manager select").change(function(){var e=$(this).parents("div.ccm-file-permissions-entity")[0];$(this).val()!=ccmi18n_filemanager.PTYPE_NONE?($(e).find(".ccm-file-access-add").show(),$(e).find(".ccm-file-access-edit").show(),$(e).find(".ccm-file-access-admin").show()):($(e).find(".ccm-file-access-add").hide(),$(e).find(".ccm-file-access-edit").hide(),$(e).find(".ccm-file-access-admin").hide(),$(e).find("div.ccm-file-access-add-extensions").hide())}),$("a.ccm-file-permissions-remove").click(function(){$(this).parent().parent().fadeOut(100,function(){$(this).remove()})}),$("input[name=toggleCanAddExtension]").unbind(),$("input[name=toggleCanAddExtension]").click(function(){var e=$(this).parent().parent().find("div.ccm-file-access-extensions");1==$(this).prop("checked")?e.find("input").attr("checked",!0):e.find("input").attr("checked",!1)})},ccm_alSetupVersionSelector=function(){$("#ccm-file-versions-grid input[type=radio]").click(function(){$("#ccm-file-versions-grid tr").removeClass("ccm-file-versions-grid-active");var t=$(this).parent().parent(),e=t.attr("fID"),i=t.attr("fvID");$.post(CCM_TOOLS_PATH+"/files/properties","task=approve_version&fID="+e+"&fvID="+i,function(e){t.addClass("ccm-file-versions-grid-active"),t.find("td").show("highlight",{color:"#FFF9BB"})})}),$(".ccm-file-versions-remove").click(function(){var t=$(this).parent().parent(),e=t.attr("fID"),i=t.attr("fvID");return $.post(CCM_TOOLS_PATH+"/files/properties","task=delete_version&fID="+e+"&fvID="+i,function(e){t.fadeOut(200,function(){t.remove()})}),!1})},ccm_alDeleteFiles=function(t){$("#ccm-"+t+"-delete-form").ajaxSubmit(function(e){ccm_parseJSON(e,function(){jQuery.fn.dialog.closeTop(),ccm_deactivateSearchResults(t),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)})})})},ccm_alDuplicateFiles=function(searchInstance){$("#ccm-"+searchInstance+"-duplicate-form").ajaxSubmit(function(resp){ccm_parseJSON(resp,function(){jQuery.fn.dialog.closeTop(),ccm_deactivateSearchResults(searchInstance);var r=eval("("+resp+")");$("#ccm-"+searchInstance+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,searchInstance);var t=new Array;for(i=0;i<r.fID.length;i++)fID=r.fID[i],ccm_uploadedFiles.push(fID),t.push(fID);ccm_alRefresh(t,searchInstance),ccm_filesUploadedDialog(searchInstance)})})})},ccm_alSetupSelectFiles=function(e){$(".ccm-file-list").unbind(),$(".ccm-file-list tr.ccm-list-record").click(function(e){e.stopPropagation(),ccm_alActivateMenu($(this),e)}),$(".ccm-file-list img.ccm-star").click(function(e){e.stopPropagation();var t=(t=$(e.target).parents("tr.ccm-list-record")[0].id).substring(3);ccm_starFile(e.target,t)}),"DASHBOARD"==ccm_alLaunchType[e]&&$(".ccm-file-list-thumbnail").hover(function(e){var t,i=$(this).attr("fID"),i=$("#fID"+i+"hoverThumbnail");0<i.length&&(t=i.find("div"),i=i.position(),t.css("top",i.top),t.css("left",i.left),t.show())},function(){var e=$(this).attr("fID");$("#fID"+e+"hoverThumbnail").find("div").hide()})},ccm_alSetupCheckboxes=function(c){var e;$("#ccm-"+c+"-list-cb-all").unbind(),$("#ccm-"+c+"-list-cb-all").click(function(){ccm_hideMenus(),1==$(this).prop("checked")?($("#ccm-"+c+"-search-results td.ccm-file-list-cb input[type=checkbox]").attr("checked",!0),$("#ccm-"+c+"-list-multiple-operations").attr("disabled",!1)):($("#ccm-"+c+"-search-results td.ccm-file-list-cb input[type=checkbox]").attr("checked",!1),$("#ccm-"+c+"-list-multiple-operations").attr("disabled",!0))}),$("#ccm-"+c+"-search-results td.ccm-file-list-cb input[type=checkbox]").click(function(e){e.stopPropagation(),ccm_hideMenus(),ccm_alRescanMultiFileMenu(c)}),$("#ccm-"+c+"-search-results td.ccm-file-list-cb").click(function(e){e.stopPropagation(),ccm_hideMenus(),$(this).find("input[type=checkbox]").click(),ccm_alRescanMultiFileMenu(c)}),"DASHBOARD"!=ccm_alLaunchType[c]&&"BROWSE"!=ccm_alLaunchType[c]&&(e=ccmi18n_filemanager.select,$("#ccm-"+c+"-list-multiple-operations option:eq(0)").after('<option value="choose">'+e+"</option>")),$("#ccm-"+c+"-list-multiple-operations").change(function(){var e=$(this).val(),t=ccm_alGetSelectedFileIDs(c);switch(e){case"choose":var i=new Array;$("#ccm-"+c+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").each(function(){i.push($(this).val())}),ccm_alSelectFile(i,!0);break;case"delete":jQuery.fn.dialog.open({width:500,height:400,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/files/delete?"+t+"&searchInstance="+c,title:ccmi18n_filemanager.deleteFile});break;case"duplicate":jQuery.fn.dialog.open({width:500,height:400,modal:!1,href:CCM_TOOLS_PATH+"/files/duplicate?"+t+"&searchInstance="+c,title:ccmi18n_filemanager.duplicateFile});break;case"sets":jQuery.fn.dialog.open({width:500,height:400,modal:!1,href:CCM_TOOLS_PATH+"/files/add_to?"+t+"&searchInstance="+c,title:ccmi18n_filemanager.sets});break;case"properties":jQuery.fn.dialog.open({width:690,height:440,modal:!1,href:CCM_TOOLS_PATH+"/files/bulk_properties?"+t+"&searchInstance="+c,title:ccmi18n.properties});break;case"rescan":jQuery.fn.dialog.open({width:350,height:200,modal:!1,href:CCM_TOOLS_PATH+"/files/rescan?"+t+"&searchInstance="+c,title:ccmi18n_filemanager.rescan,onClose:function(){$("#ccm-"+c+"-advanced-search").submit()}});break;case"download":window.frames[ccm_alProcessorTarget].location=CCM_TOOLS_PATH+"/files/download?"+t}$(this).get(0).selectedIndex=0}),ccm_alSetupFileSetSearch(c)},ccm_alSetupFileSetSearch=function(e){$("#ccm-"+e+"-sets-search-wrapper select").chosen(ccmi18n_chosen).unbind(),$("#ccm-"+e+"-sets-search-wrapper select").chosen(ccmi18n_chosen).change(function(){$("#ccm-"+e+"-sets-search-wrapper option:selected");$("#ccm-"+e+"-advanced-search").submit()})},ccm_alGetSelectedFileIDs=function(e){var t="";return $("#ccm-"+e+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").each(function(){t+="fID[]="+$(this).val()+"&"}),t},ccm_alRescanMultiFileMenu=function(e){0<$("#ccm-"+e+"-search-results td.ccm-file-list-cb input[type=checkbox]:checked").length?$("#ccm-"+e+"-list-multiple-operations").attr("disabled",!1):$("#ccm-"+e+"-list-multiple-operations").attr("disabled",!0)},ccm_alSetupFileProcessor=function(){if(""!=ccm_alProcessorTarget)return!1;var t,e=parseInt((new Date).getTime().toString().substring(0,10));try{t=document.createElement('<iframe name="ccm-al-upload-processor'+e+'">')}catch(e){t=document.createElement("iframe")}t.id="ccm-al-upload-processor"+e,t.name="ccm-al-upload-processor"+e,t.style.border="0px",t.style.width="0px",t.style.height="0px",t.style.display="none",document.body.appendChild(t),ccm_alProcessorTarget=ccm_alDebug?"_blank":"ccm-al-upload-processor"+e},ccm_alSubmitSingle=function(e){if(""==$(e).find(".ccm-al-upload-single-file").val())return!1;$(e).find(".ccm-al-upload-single-submit").hide(),$(e).find(".ccm-al-upload-single-loader").show()},ccm_alResetSingle=function(){$(".ccm-al-upload-single-file").val(""),$(".ccm-al-upload-single-loader").hide(),$(".ccm-al-upload-single-submit").show()},[]),checkbox_status=(ccm_filesUploadedDialog=function(t){document.getElementById("ccm-file-upload-multiple-tab")&&jQuery.fn.dialog.closeTop();for(var e="",i=0;i<ccm_uploadedFiles.length;i++)e=e+"&fID[]="+ccm_uploadedFiles[i];jQuery.fn.dialog.open({width:690,height:440,modal:!1,href:CCM_TOOLS_PATH+"/files/bulk_properties/?"+e+"&uploaded=true&searchInstance="+t,onClose:function(){ccm_deactivateSearchResults(t),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)})},title:ccmi18n_filemanager.uploadComplete}),ccm_uploadedFiles=[]},ccm_alSetupUploadDetailsForm=function(e){$("#ccm-"+e+"-update-uploaded-details-form").submit(function(){return ccm_alSubmitUploadDetailsForm(e),!1})},ccm_alSubmitUploadDetailsForm=function(searchInstance){jQuery.fn.dialog.showLoader(),$("#ccm-"+searchInstance+"-update-uploaded-details-form").ajaxSubmit(function(r1){var r1a=eval("("+r1+")"),form=$("#ccm-"+searchInstance+"-advanced-search");0<form.length?form.ajaxSubmit(function(e){$("#ccm-"+searchInstance+"-sets-search-wrapper").load(CCM_TOOLS_PATH+"/files/search_sets_reload",{searchInstance:searchInstance},function(){jQuery.fn.dialog.hideLoader(),jQuery.fn.dialog.closeTop(),ccm_parseAdvancedSearchResponse(e,searchInstance),ccm_alHighlightFileIDArray(r1a)})}):(jQuery.fn.dialog.hideLoader(),jQuery.fn.dialog.closeTop())})},ccm_alRefresh=function(e,t,i){var c=e;ccm_deactivateSearchResults(t),$("#ccm-"+t+"-search-results").load(CCM_TOOLS_PATH+"/files/search_results",{ccm_order_by:"fvDateAdded",ccm_order_dir:"desc",fileSelector:i,searchType:ccm_alLaunchType[t],searchInstance:t},function(){ccm_activateSearchResults(t),0!=c&&ccm_alHighlightFileIDArray(c),ccm_alSetupSelectFiles(t)})},ccm_alHighlightFileIDArray=function(e){for(i=0;i<e.length;i++){var t=$("tr[fID="+e[i]+"] td"),c=t.css("backgroundColor");t.animate({backgroundColor:"#FFF9BB"},{queue:!0,duration:1e3}).animate({backgroundColor:c},500)}},ccm_alSelectFile=function(e){if("function"==typeof ccm_chooseAsset){var t="";if("object"==typeof e)for(i=0;i<e.length;i++)t+="fID[]="+e[i]+"&";else t+="fID="+e;$.getJSON(CCM_TOOLS_PATH+"/files/get_data.php?"+t,function(e){ccm_parseJSON(e,function(){for(i=0;i<e.length;i++)ccm_chooseAsset(e[i]);jQuery.fn.dialog.closeTop()})})}else{if("object"==typeof e)for(i=0;i<e.length;i++)ccm_triggerSelectFile(e[i]);else ccm_triggerSelectFile(e);jQuery.fn.dialog.closeTop()}},ccm_alActivateMenu=function(e,t){var i,c,a,s,n=$(e).find("div[ccm-file-manager-field]"),o="",l=(o=(o=0<n.length?n.attr("ccm-file-manager-field"):o)||ccm_alActiveAssetField,ccm_hideMenus(),$(e).attr("fID")),r=$(e).attr("ccm-file-manager-instance"),d=document.getElementById("ccm-al-menu"+l+r+o);d?d=$("#ccm-al-menu"+l+r+o):((el=document.createElement("DIV")).id="ccm-al-menu"+l+r+o,el.className="ccm-menu ccm-ui",el.style.display="block",el.style.visibility="hidden",document.body.appendChild(el),c=$("div[ccm-file-manager-field="+o+"] input.ccm-file-manager-filter"),i="",0<c.length&&c.each(function(){i+="&"+$(this).attr("name")+"="+$(this).attr("value")}),$(e).attr("al-filepath"),(d=$("#ccm-al-menu"+l+r+o)).css("position","absolute"),c='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">',c+="<ul>","DASHBOARD"!=ccm_alLaunchType[r]&&"BROWSE"!=ccm_alLaunchType[r]&&(a=0<n.length?"ccm_alLaunchSelectorFileManager('"+o+"')":"ccm_alSelectFile("+l+")",s=0<n.length?ccmi18n_filemanager.chooseNew:ccmi18n_filemanager.select,c+='<li><a class="ccm-menu-icon ccm-icon-choose-file-menu" dialog-modal="false" dialog-width="90%" dialog-height="70%" dialog-title="'+ccmi18n_filemanager.select+'" id="menuSelectFile'+l+'" href="javascript:void(0)" onclick="'+a+'">'+s+"</a></li>"),0<n.length&&(c+='<li><a class="ccm-menu-icon ccm-icon-clear-file-menu" href="javascript:void(0)" id="menuClearFile'+l+r+o+'">'+ccmi18n_filemanager.clear+"</a></li>"),"DASHBOARD"!=ccm_alLaunchType[r]&&"BROWSE"!=ccm_alLaunchType[r]&&0<n.length&&(c+='<li class="ccm-menu-separator"></li>'),"1"==$(e).attr("ccm-file-manager-can-view")?c+='<li><a class="ccm-menu-icon ccm-icon-view dialog-launch" dialog-modal="false" dialog-append-buttons="true" dialog-width="90%" dialog-height="75%" dialog-title="'+ccmi18n_filemanager.view+'" id="menuView'+l+'" href="'+CCM_TOOLS_PATH+"/files/view?fID="+l+'">'+ccmi18n_filemanager.view+"</a></li>":c+='<li><a class="ccm-menu-icon ccm-icon-download-menu" href="javascript:void(0)" id="menuDownload'+l+'" onclick="window.frames[\''+ccm_alProcessorTarget+"'].location='"+CCM_TOOLS_PATH+"/files/download?fID="+l+"'\">"+ccmi18n_filemanager.download+"</a></li>","1"==$(e).attr("ccm-file-manager-can-edit")&&(c+='<li><a class="ccm-menu-icon ccm-icon-edit-menu dialog-launch" dialog-modal="false" dialog-width="90%" dialog-height="75%" dialog-title="'+ccmi18n_filemanager.edit+'" id="menuEdit'+l+'" href="'+CCM_TOOLS_PATH+"/files/edit?searchInstance="+r+"&fID="+l+i+'">'+ccmi18n_filemanager.edit+"</a></li>"),c+='<li><a class="ccm-menu-icon ccm-icon-properties-menu dialog-launch" dialog-modal="false" dialog-width="680" dialog-height="450" dialog-title="'+ccmi18n_filemanager.properties+'" id="menuProperties'+l+'" href="'+CCM_TOOLS_PATH+"/files/properties?searchInstance="+r+"&fID="+l+'">'+ccmi18n_filemanager.properties+"</a></li>","1"==$(e).attr("ccm-file-manager-can-replace")&&(c+='<li><a class="ccm-menu-icon ccm-icon-replace dialog-launch" dialog-modal="false" dialog-width="300" dialog-height="260" dialog-title="'+ccmi18n_filemanager.replace+'" id="menuFileReplace'+l+'" href="'+CCM_TOOLS_PATH+"/files/replace?searchInstance="+r+"&fID="+l+'">'+ccmi18n_filemanager.replace+"</a></li>"),"1"==$(e).attr("ccm-file-manager-can-duplicate")&&(c+='<li><a class="ccm-menu-icon ccm-icon-copy-menu" id="menuFileDuplicate'+l+'" href="javascript:void(0)" onclick="ccm_alDuplicateFile('+l+",'"+r+"')\">"+ccmi18n_filemanager.duplicate+"</a></li>"),c+='<li><a class="ccm-menu-icon ccm-icon-sets dialog-launch" dialog-modal="false" dialog-width="500" dialog-height="400" dialog-title="'+ccmi18n_filemanager.sets+'" id="menuFileSets'+l+'" href="'+CCM_TOOLS_PATH+"/files/add_to?searchInstance="+r+"&fID="+l+'">'+ccmi18n_filemanager.sets+"</a></li>","1"!=$(e).attr("ccm-file-manager-can-admin")&&"1"!=$(e).attr("ccm-file-manager-can-delete")||(c+='<li class="ccm-menu-separator"></li>'),"1"==$(e).attr("ccm-file-manager-can-admin")&&(c+='<li><a class="ccm-menu-icon ccm-icon-access-permissions dialog-launch" dialog-modal="false" dialog-width="400" dialog-height="450" dialog-title="'+ccmi18n_filemanager.permissions+'" id="menuFilePermissions'+l+'" href="'+CCM_TOOLS_PATH+"/files/permissions?searchInstance="+r+"&fID="+l+'">'+ccmi18n_filemanager.permissions+"</a></li>"),"1"==$(e).attr("ccm-file-manager-can-delete")&&(c+='<li><a class="ccm-icon-delete-menu ccm-menu-icon dialog-launch" dialog-append-buttons="true" dialog-modal="false" dialog-width="500" dialog-height="200" dialog-title="'+ccmi18n_filemanager.deleteFile+'" id="menuDeleteFile'+l+'" href="'+CCM_TOOLS_PATH+"/files/delete?searchInstance="+r+"&fID="+l+'">'+ccmi18n_filemanager.deleteFile+"</a></li>"),d.append(c=c+"</ul>"+"</div></div></div>"),$(d).find("a").bind("click.hide-menu",function(e){return ccm_hideMenus(),!1}),$("#ccm-al-menu"+l+r+o+" a.dialog-launch").dialog(),$("a#menuClearFile"+l+r+o).click(function(e){ccm_clearFile(e,o),ccm_hideMenus()})),ccm_fadeInMenu(d,t)},ccm_alSelectNone=function(){ccm_hideMenus()},!1),quickSaveLayoutObj,deleteLayoutObj;function ccmLayout(areaNameNumber,cvalID,layout_id,area,locked){this.layout_id=layout_id,this.cvalID=cvalID,this.locked=locked,this.area=area,this.areaNameNumber=areaNameNumber,this.init=function(){var t=this;this.layoutWrapper=$("#ccm-layout-wrapper-"+this.cvalID),this.ccmControls=this.layoutWrapper.find("#ccm-layout-controls-"+this.cvalID),(this.ccmControls.get(0).layoutObj=this).ccmControls.mouseover(function(){t.dontUpdateTwins=0,t.highlightAreas(1)}),this.ccmControls.mouseout(function(){t.moving||t.highlightAreas(0)}),this.ccmControls.find(".ccm-layout-menu-button").click(function(e){t.optionsMenu(e)}),this.gridSizing()},this.highlightAreas=function(e){var t=this.layoutWrapper.find(".ccm-add-block");e?t.addClass("ccm-layout-area-highlight"):t.removeClass("ccm-layout-area-highlight")},this.optionsMenu=function(e){ccm_hideMenus(),e.stopPropagation(),ccm_menuActivated=!0;var t,i,c,a=document.getElementById("ccm-layout-options-menu-"+this.cvalID);a?a=$("#ccm-layout-options-menu-"+this.cvalID):((el=document.createElement("DIV")).id="ccm-layout-options-menu-"+this.cvalID,el.className="ccm-menu ccm-ui",el.style.display="none",document.body.appendChild(el),(a=$(el)).css("position","absolute"),t='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">',t=(t=(t=(t+="<ul>")+'<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-edit-menu" dialog-title="'+ccmi18n.editAreaLayout+'" dialog-modal="false" dialog-width="550" dialog-height="280" dialog-append-buttons="true" id="menuEditLayout'+this.cvalID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&cvalID="+this.cvalID+'&atask=layout">'+ccmi18n.editAreaLayout+"</a></li>")+'<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-move-up" id="menuAreaLayoutMoveUp'+this.cvalID+'">'+ccmi18n.moveLayoutUp+"</a></li>")+'<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-move-down" id="menuAreaLayoutMoveDown'+this.cvalID+'">'+ccmi18n.moveLayoutDown+"</a></li>",i=this.locked?ccmi18n.unlockAreaLayout:ccmi18n.lockAreaLayout,t=(t+='<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-lock-menu" id="menuAreaLayoutLock'+this.cvalID+'">'+i+"</a></li>")+'<li><a onclick="ccm_hideMenus()" href="javascript:void(0)" class="ccm-menu-icon ccm-icon-delete-menu" dialog-append-buttons="true" id="menuAreaLayoutDelete'+this.cvalID+'">'+ccmi18n.deleteLayout+"</a></li>",a.append(t=t+"</ul>"+"</div></div></div>"),(i=$(a)).find("#menuEditLayout"+(c=this).cvalID).dialog(),i.find("#menuAreaLayoutMoveUp"+this.cvalID).click(function(){c.moveLayout("up")}),i.find("#menuAreaLayoutMoveDown"+this.cvalID).click(function(){c.moveLayout("down")}),i.find("#menuAreaLayoutLock"+this.cvalID).click(function(){c.lock()}),i.find("#menuAreaLayoutDelete"+this.cvalID).click(function(){c.deleteLayoutOptions()})),ccm_fadeInMenu(a,e)},this.moveLayout=function(direction){this.moving=1,ccm_hideHighlighter(),this.highlightAreas(1),this.servicesAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&cvalID="+this.cvalID+"&task=move&direction="+direction+"&areaNameNumber="+this.areaNameNumber,success:function(response){eval("var jObj="+response),1!=parseInt(jObj.success)?alert(jObj.msg):ccm_mainNavDisableDirectExit()}});var el=$("#ccm-layout-wrapper-"+this.cvalID),layoutObj=this,nextLayout,previousLayout;"down"==direction?(nextLayout=el.next(),nextLayout.hasClass("ccm-layout-wrapper")?el.slideUp(600,function(){el.insertAfter(nextLayout),el.slideDown(600,function(){layoutObj.highlightAreas(0),layoutObj.moving=0})}):ccmAlert.hud(ccmi18n.moveLayoutAtBoundary,4e3,"icon_move_down",ccmi18n.moveLayoutDown)):"up"==direction&&(previousLayout=el.prev(),previousLayout.hasClass("ccm-layout-wrapper")?el.slideUp(600,function(){el.insertBefore(previousLayout),el.slideDown(600,function(){layoutObj.highlightAreas(0),layoutObj.moving=0})}):ccmAlert.hud(ccmi18n.moveLayoutAtBoundary,4e3,"icon_move_up",ccmi18n.moveLayoutUp))},this.lock=function(lock,twinLock){var a=$("#menuAreaLayoutLock"+this.cvalID),lock=(this.locked=!this.locked,this.locked?(a.html(ccmi18n.unlockAreaLayout),this.s&&this.s.slider("disable")):(a.find("span").html(ccmi18n.lockAreaLayout),this.s&&this.s.slider("enable")),this.locked?1:0);if(!twinLock){this.servicesAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&task=lock&lock="+lock,success:function(response){eval("var jObj="+response),1!=parseInt(jObj.success)&&alert(jObj.msg)}}),this.getTwins();for(var i=0;i<this.layoutTwinObjs.length;i++)this.layoutTwinObjs[i].lock(lock,1)}},this.hasBeenQuickSaved=0,this.quickSaveLayoutId=0,this.quickSave=function(){var breakPoints=this.ccmControls.find("#layout_col_break_points_"+this.cvalID).val().replace(/%/g,""),layoutObj,modifyLayoutId;clearTimeout(this.secondSavePauseTmr),!this.hasBeenQuickSaved&&this.quickSaveInProgress?(quickSaveLayoutObj=this,this.secondSavePauseTmr=setTimeout("quickSaveLayoutObj.quickSave()",100)):(this.quickSaveInProgress=1,layoutObj=this,modifyLayoutId=this.quickSaveLayoutId||this.layout_id,this.quickSaveAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+modifyLayoutId+"&task=quicksave&breakpoints="+encodeURIComponent(breakPoints),success:function(response){eval("var jObj="+response),1!=parseInt(jObj.success)?alert(jObj.msg):(layoutObj.hasBeenQuickSaved=1,layoutObj.quickSaveInProgress=0,jObj.layoutID&&(layoutObj.quickSaveLayoutId=jObj.layoutID),ccm_mainNavDisableDirectExit())}}))},this.deleteLayoutOptions=function(){var i=0,e=((deleteLayoutObj=this).layoutWrapper.find(".ccm-block").each(function(e,t){"none"!=t.style.display&&(i=1)}),i?"135px":"70px");$.fn.dialog.open({title:ccmi18n.deleteLayoutOptsTitle,href:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&task=deleteOpts&hasBlocks="+i,width:"340px",modal:!1,appendButtons:!0,height:e})},this.deleteLayout=function(deleteBlocks){ccm_hideMenus(),jQuery.fn.dialog.closeTop(),this.layoutWrapper.slideUp(300),jQuery.fn.dialog.showLoader();var cvalID=this.cvalID;this.servicesAjax=$.ajax({url:CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(this.area)+"&layoutID="+this.layout_id+"&task=delete&deleteBlocks="+parseInt(deleteBlocks)+"&areaNameNumber="+this.areaNameNumber,success:function(response){eval("var jObj="+response),1!=parseInt(jObj.success)?(alert(jObj.msg),jQuery.fn.dialog.hideLoader()):($("#ccm-layout-wrapper-"+cvalID).remove(),ccm_hideHighlighter(),ccm_mainNavDisableDirectExit(),jObj.refreshPage?window.location=window.location:jQuery.fn.dialog.hideLoader())}})},this.gridSizing=function(){var e;this.ccmGrid=$("#ccm-layout-"+this.layout_id),1<parseInt(this.ccmControls.find(".layout_column_count").val())&&(e=this.ccmControls.find("#layout_col_break_points_"+this.cvalID).val().replace(/%/g,"").split("|"),this.s=this.ccmControls.find(".ccm-layout-controls-slider"),(this.s.get(0).layoutObj=this).s.get(0).ccmGrid=this.ccmGrid,this.s.slider({step:1,values:e,change:function(){if(!this.layoutObj.dontUpdateTwins){this.layoutObj.resizeGrid(this.childNodes);for(var e=[],t=0;t<this.childNodes.length;t++)e.push(parseFloat(this.childNodes[t].style.left.replace("%","")));e.sort(function(e,t){return e-t}),this.layoutObj.ccmControls.find(".layout_col_break_points").val(e.join("%|")+"%"),this.layoutObj.quickSave(),ccm_arrangeMode=0,this.layoutObj.moving=0,this.layoutObj.highlightAreas(0)}},slide:function(){ccm_arrangeMode=1,this.layoutObj.moving=1,this.layoutObj.dontUpdateTwins||this.layoutObj.resizeGrid(this.childNodes)}}),parseInt(this.ccmControls.find(".layout_locked").val()))&&this.s.slider("disable")},this.getTwins=function(){if(!this.layoutTwins){this.layoutTwins=$(".ccm-layout-controls-layoutID-"+this.layout_id).not(this.ccmControls),this.layoutTwinObjs=[];for(var e=0;e<this.layoutTwins.length;e++)this.layoutTwinObjs.push(this.layoutTwins[e].layoutObj),this.layoutTwins[e].handles=$(this.layoutTwins[e]).find(".ui-slider-handle")}return this.layoutTwins},this.resizeGrid=function(e){var t=[];this.getTwins();for(var i=0;i<e.length;i++){var c=parseFloat(e[i].style.left.replace("%",""));if(t.push(c),!this.dontUpdateTwins)for(var a=0;a<this.layoutTwinObjs.length;a++)this.layoutTwinObjs[a].dontUpdateTwins=1,this.layoutTwinObjs[a].s.slider("values",i,c)}t.sort(function(e,t){return e-t});for(var s=0,n=0;n<t.length;n++)if(s+=a=(c=t[n])-s,$(".ccm-layout-"+this.layout_id+"-col-"+(n+1)).css("width",a+"%"),!this.dontUpdateTwins)for(j=0;j<this.layoutTwins.length;j++)this.layoutTwins[j].handles[n].style.left=c+"%";$(".ccm-layout-"+this.layout_id+"-col-"+(n+1)).css("width",100-s+"%")}}toggleCheckboxStatus=function(e){if(checkbox_status){for(i=0;i<e.elements.length;i++)"checkbox"==e.elements[i].type&&(e.elements[i].checked=!1);checkbox_status=!1}else{for(i=0;i<e.elements.length;i++)"checkbox"==e.elements[i].type&&(e.elements[i].checked=!0);checkbox_status=!0}},ccm_alDuplicateFile=function(fID,searchInstance){var postStr="fID="+fID+"&searchInstance="+searchInstance;$.post(CCM_TOOLS_PATH+"/files/duplicate",postStr,function(resp){var r=eval("("+resp+")");if(1==r.error)return ccmAlert.notice(ccmi18n.error,r.message),!1;var highlight=new Array;r.fID&&(highlight.push(r.fID),ccm_alRefresh(highlight,searchInstance),ccm_uploadedFiles.push(r.fID),ccm_filesUploadedDialog(searchInstance))})},ccm_alSelectMultipleIncomingFiles=function(e){$(e).prop("checked")?$("input.ccm-file-select-incoming").attr("checked",!0):$("input.ccm-file-select-incoming").attr("checked",!1)},ccm_starFile=function(e,t){var i="",i=-1!=$(e).attr("src").indexOf(CCM_STAR_STATES.unstarred)?($(e).attr("src",$(e).attr("src").replace(CCM_STAR_STATES.unstarred,CCM_STAR_STATES.starred)),"star"):($(e).attr("src",$(e).attr("src").replace(CCM_STAR_STATES.starred,CCM_STAR_STATES.unstarred)),"unstar");$.post(CCM_TOOLS_PATH+"/"+CCM_STAR_ACTION,{action:i,"file-id":t},function(e,t){})},jQuery.cookie=function(e,t,i){if(void 0===t){var c=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),s=0;s<a.length;s++){var n=jQuery.trim(a[s]);if(n.substring(0,e.length+1)==e+"="){c=decodeURIComponent(n.substring(e.length+1));break}}return c}i=i||{},null===t&&(t="",(i=$.extend({},i)).expires=-1);var o="",l=(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)&&("number"==typeof i.expires?(l=new Date).setTime(l.getTime()+24*i.expires*60*60*1e3):l=i.expires,o="; expires="+l.toUTCString()),i.path?"; path="+i.path:""),r=i.domain?"; domain="+i.domain:"",i=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),o,l,r,i].join("")};var ccmLayoutEdit={init:function(){this.showPresetDeleteIcon(),$("#ccmLayoutPresentIdSelector").change(function(){var e=parseInt($(this).val()),t=$("#ccmAreaLayoutForm_layoutID").val();jQuery.fn.dialog.showLoader(),e=0<e?$("#ccm-layout-refresh-action").val()+"&lpID="+e:$("#ccm-layout-refresh-action").val()+"&layoutID="+t,$.get(e,function(e){$("#ccm-layout-edit-wrapper").html(e),jQuery.fn.dialog.hideLoader(),ccmLayoutEdit.showPresetDeleteIcon()})}),$("#layoutPresetActionNew input[name=layoutPresetAction]").click(function(){"create_new_preset"==$(this).val()&&$(this).prop("checked")?$("input[name=layoutPresetName]").attr("disabled",!1).focus():$("input[name=layoutPresetName]").val("").attr("disabled",!0)}),$("#layoutPresetActions input[name=layoutPresetAction]").click(function(){"create_new_preset"==$(this).val()&&$(this).prop("checked")?$("input[name=layoutPresetNameAlt]").attr("disabled",!1).focus():$("input[name=layoutPresetNameAlt]").val("").attr("disabled",!0)}),0<$("#layoutPresetActions").length&&$("#ccmLayoutConfigOptions input, #ccmLayoutConfigOptions select").bind("change click",function(){$("#layoutPresetActions").show(),$("#layoutPresetActionNew").hide(),$("#ccmLayoutConfigOptions input, #ccmLayoutConfigOptions select").unbind("change click")})},showPresetDeleteIcon:function(){0<$("#ccmLayoutPresentIdSelector").val()?$("#ccm-layout-delete-preset").show():$("#ccm-layout-delete-preset").hide()},deletePreset:function(){var lpID=parseInt($("#ccmLayoutPresentIdSelector").val());if(0<lpID){if(!confirm(ccmi18n.confirmLayoutPresetDelete))return!1;jQuery.fn.dialog.showLoader();var area=$("#ccmAreaLayoutForm_arHandle").val(),url=CCM_TOOLS_PATH+"/layout_services/?cID="+CCM_CID+"&arHandle="+encodeURIComponent(area)+"&task=deletePreset&lpID="+lpID;$.get(url,function(r){eval("var jObj="+r),1!=parseInt(jObj.success)?alert(jObj.msg):$("#ccmLayoutPresentIdSelector option[value='"+lpID+"']").remove(),jQuery.fn.dialog.hideLoader()})}}},imgLoader,ccm_dialogOpen=($.widget.bridge("jqdialog",$.ui.dialog),jQuery.fn.dialog=function(){if(0<arguments.length)$(this).jqdialog(arguments[0],arguments[1],arguments[2]);else{if(!$(this).is("div"))return $(this).each(function(){$(this).unbind("click.make-dialog").bind("click.make-dialog",function(e){var t=$(this).attr("href"),i=$(this).attr("dialog-width"),c=$(this).attr("dialog-height"),a=$(this).attr("dialog-title"),s=$(this).attr("dialog-on-open"),n=$(this).attr("dialog-on-destroy"),o=$(this).attr("dialog-on-close");return obj={modal:!0,href:t,width:i,height:c,title:a,onOpen:s,onDestroy:n,onClose:o},jQuery.fn.dialog.open(obj),!1})});$(this).jqdialog()}},jQuery.fn.dialog.close=function(e){e++,$("#ccm-dialog-content"+e).jqdialog("close")},jQuery.fn.dialog.open=function(obj){jQuery.fn.dialog.showLoader(),ccm_uiLoaded&&ccm_hideMenus();var nd=$(".ui-dialog").length;nd++,$("body").append('<div id="ccm-dialog-content'+nd+'" style="display: none"></div>'),"string"==typeof obj.width?(0<obj.width.indexOf("%",0)?(w=obj.width.replace("%",""),w=$(window).width()*(w/100),w+=50):w=parseInt(obj.width)+50,0<obj.height.indexOf("%",0)?(h=obj.height.replace("%",""),h=$(window).height()*(h/100),h+=100):h=parseInt(obj.height)+100):h=obj.width?(w=parseInt(obj.width)+50,parseInt(obj.height)+100):(w=550,400),h>$(window).height()&&(h=$(window).height()),$("#ccm-dialog-content"+nd).jqdialog({modal:!0,height:h,width:w,show:{effect:"fade",duration:150,easing:"easeInExpo"},escapeClose:!0,title:obj.title,open:function(){1==$(".ui-dialog").length&&($("body").attr("data-last-overflow",$("body").css("overflow")),$("body").css("overflow","hidden"))},beforeClose:function(){1==$(".ui-dialog").length&&$("body").css("overflow",$("body").attr("data-last-overflow"))},close:function(ev,u){$(this).jqdialog("destroy").remove(),$("#ccm-dialog-content"+nd).remove(),void 0!==obj.onClose&&("function"==typeof obj.onClose?obj.onClose():eval(obj.onClose)),void 0!==obj.onDestroy&&("function"==typeof obj.onDestroy?obj.onDestroy():eval(obj.onDestroy)),nd--}}),obj.element?(jQuery.fn.dialog.hideLoader(),jQuery.fn.dialog.replaceTop($(obj.element)),void 0!==obj.onOpen&&("function"==typeof obj.onOpen?obj.onOpen():eval(obj.onOpen))):$.ajax({type:"GET",url:obj.href,success:function(r){jQuery.fn.dialog.hideLoader(),jQuery.fn.dialog.replaceTop(r),void 0!==obj.onOpen&&("function"==typeof obj.onOpen?obj.onOpen():eval(obj.onOpen))}})},jQuery.fn.dialog.replaceTop=function(e){var t,i,c=$(".ui-dialog").length;"string"==typeof e?$("#ccm-dialog-content"+c).html(e):"none"==(e=e.clone(!0,!0).appendTo("#ccm-dialog-content"+c)).css("display")&&e.show(),$("#ccm-dialog-content"+c+" .dialog-launch").dialog(),$("#ccm-dialog-content"+c+" .ccm-dialog-close").click(function(e){e.preventDefault(),jQuery.fn.dialog.closeTop()}),0<$("#ccm-dialog-content"+c+" .dialog-buttons").length&&($("#ccm-dialog-content"+c).jqdialog("option","buttons",[{}]),$("#ccm-dialog-content"+c).parent().find(".ui-dialog-buttonset").remove(),$("#ccm-dialog-content"+c).parent().find(".ui-dialog-buttonpane").html(""),$("#ccm-dialog-content"+c+" .dialog-buttons").appendTo($("#ccm-dialog-content"+c).parent().find(".ui-dialog-buttonpane").addClass("ccm-ui"))),0<$("#ccm-dialog-content"+c+" .dialog-help").length&&($("#ccm-dialog-content"+c+" .dialog-help").hide(),t=$("#ccm-dialog-content"+c+" .dialog-help").html(),e=ccmi18n.helpPopup||"Help",$("#ccm-dialog-content"+c).parent().find(".ui-dialog-titlebar").append('<span class="ccm-dialog-help"><a href="javascript:void(0)" title="'+e+'" class="ccm-menu-help-trigger">Help</a></span>'),(i=$("#ccm-dialog-content"+c).parent().find(".ui-dialog-titlebar .ccm-menu-help-trigger").popover({content:function(){return t},placement:"bottom",html:!0,trigger:"click"})).length)&&i.closest(".ui-dialog").on("dialogbeforeclose",function(){void 0!==i.data("popover")&&i.data("popover").hide()})},jQuery.fn.dialog.showLoader=function(e){if(void 0===imgLoader||!imgLoader||!imgLoader.src)return!1;$("#ccm-dialog-loader").length<1&&$("body").append("<div id='ccm-dialog-loader-wrapper' class='ccm-ui'><img id='ccm-dialog-loader' src='"+imgLoader.src+"' /></div>"),null!=e&&$("<div />").attr("id","ccm-dialog-loader-text").html(e).prependTo($("#ccm-dialog-loader-wrapper"));var e=$("#ccm-dialog-loader-wrapper").width(),t=$("#ccm-dialog-loader-wrapper").height(),e=($(window).width()-e)/2,t=($(window).height()-t)/2;$("#ccm-dialog-loader-wrapper").css("left",e+"px").css("top",t+"px"),$("#ccm-dialog-loader-wrapper").show()},jQuery.fn.dialog.hideLoader=function(){$("#ccm-dialog-loader-wrapper").hide(),$("#ccm-dialog-loader-text").remove()},jQuery.fn.dialog.closeTop=function(){var e=$(".ui-dialog").length;$("#ccm-dialog-content"+e).jqdialog("close")},jQuery.fn.dialog.closeAll=function(){$($(".ui-dialog-content").get().reverse()).jqdialog("close")},0),ccmAlert=(jQuery.fn.dialog.loaderImage=CCM_IMAGE_PATH+"/throbber_white_32.gif",{notice:function(e,t,i){$.fn.dialog.open({href:CCM_TOOLS_PATH+"/alert",title:e,width:320,height:160,modal:!1,onOpen:function(){$("#ccm-popup-alert-message").html(t)},onDestroy:i})},hud:function(e,t,i,c){0==$("#ccm-notification-inner").length&&$(document.body).append('<div id="ccm-notification" class="ccm-ui"><div id="ccm-notification-inner"></div></div>'),null==i&&(i="edit_small"),c=null==c?e:"<h3>"+c+"</h3>"+e,$("#ccm-notification-inner").html('<img id="ccm-notification-icon" src="'+CCM_IMAGE_PATH+"/icons/"+i+'.png" width="16" height="16" /><div id="ccm-notification-message">'+c+"</div>"),$("#ccm-notification").show(),0<t&&setTimeout(function(){$("#ccm-notification").fadeOut({easing:"easeOutExpo",duration:300})},t)}}),ccm_searchActivatePostFunction=($(document).ready(function(){(imgLoader=new Image).src=jQuery.fn.dialog.loaderImage}),ccm_closeNewsflow=function(e){($ovl=ccm_getNewsflowOverlayWindow()).fadeOut(300,"easeOutExpo"),$(".ui-widget-overlay").fadeOut(300,"easeOutExpo",function(){$(this).remove()})},ccm_setNewsflowPagingArrowHeight=function(){var e=(0<$("#ccm-marketplace-detail").length?$("#ccm-marketplace-detail"):$("#newsflow-main")).height();$(".newsflow-paging-previous a, .newsflow-paging-next a").css("height",e+"px"),$(".newsflow-paging-previous, .newsflow-paging-next").css("height",e+"px"),$(".newsflow-paging-next").show(),$(".newsflow-paging-previous").show()},ccm_setNewsflowOverlayDimensions=function(){var e,t,i,c;0<$("#newsflow-overlay").length&&(e=$("#newsflow-overlay").width(),c=$(window).width(),t=$(window).height(),h=650<(i=t-80)?650:i,$("#newsflow-overlay").css("height",650),i=(c-e)/2,c=29+(c=(t-h)/2),i+="px",c+="px",$("#newsflow-overlay").css("left",i).css("top",c))},ccm_getNewsflowOverlayWindow=function(){return 0<$("#ccm-dashboard-content").length&&0<$("#newsflow-main").length&&0==$("#newsflow-overlay").length?$("#newsflow-main").parent():0<$("#newsflow-overlay").length?$("#newsflow-overlay"):$("<div />").attr("id","newsflow-overlay").attr("class","ccm-ui").css("display","none").appendTo(document.body)},ccm_showNewsflowOverlayWindow=function(e,t){0<$("#ccm-dashboard-content").length&&0<$("#newsflow-main").length||($(".ui-widget-overlay").length<1&&$('<div class="ui-widget-overlay"></div>').hide().appendTo("body"),$(".ui-widget-overlay").show()),$(window).resize(function(){ccm_setNewsflowOverlayDimensions()}),($ovl=ccm_getNewsflowOverlayWindow()).load(e,function(){$ovl.hide(),$(".newsflow-paging-next").hide(),$(".newsflow-paging-previous").hide(),$ovl.html($(this).html()),t&&t(),ccm_setNewsflowOverlayDimensions(),ccm_setupTrickleUpNewsflowStyles(),$ovl.fadeIn("300","easeOutExpo",function(){ccm_setNewsflowPagingArrowHeight()})})},ccm_setupTrickleUpNewsflowStyles=function(){(ovl=ccm_getNewsflowOverlayWindow()).find(".newsflow-em1").each(function(){$(this).parent().addClass("newsflow-em1")})},ccm_showDashboardNewsflowWelcome=function(){jQuery.fn.dialog.showLoader(ccmi18n.newsflowLoading),ccm_showNewsflowOverlayWindow(CCM_DISPATCHER_FILENAME+"/dashboard/home?_ccm_dashboard_external=1",function(){jQuery.fn.dialog.hideLoader()})},ccm_showNewsflowOffsite=function(e){jQuery.fn.dialog.showLoader(),ccm_showNewsflowOverlayWindow(CCM_TOOLS_PATH+"/newsflow?cID="+e,function(){jQuery.fn.dialog.hideLoader()})},ccm_showAppIntroduction=function(){ccm_showNewsflowOverlayWindow(CCM_DISPATCHER_FILENAME+"/dashboard/welcome?_ccm_dashboard_external=1")},ccm_getNewsflowByPath=function(e){jQuery.fn.dialog.showLoader(),ccm_showNewsflowOverlayWindow(CCM_TOOLS_PATH+"/newsflow?cPath="+e,function(){jQuery.fn.dialog.hideLoader()})},ccm_doPageReindexing=function(){$.get(CCM_TOOLS_PATH+"/reindex_pending_pages?ccm_token="+CCM_SECURITY_TOKEN)},String.prototype.score=function(e,t){if(t=t||0,0==e.length)return.9;if(!(e.length>this.length))for(var i=e.length;0<i;i--){var c=e.substring(0,i),a=this.indexOf(c);if(!(a<0)&&!(a+e.length>this.length+t)){var c=this.substring(a+c.length),s=null,s=i>=e.length?"":e.substring(i),s=c.score(s,t+a);if(0<s){var n=this.length-c.length;if(0!=a){var o=0,l=this.charCodeAt(a-1);if(32==l||9==l)for(o=a-2;0<=o;o--)n-=32==(l=this.charCodeAt(o))||9==l?1:.15;else n-=a}return n=(n+=s*c.length)/this.length}}}return 0},ccm_openThemeLauncher=function(){jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader(),ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/themes",width:"905",modal:!1,height:"410"})},"open_theme_launcher")},ccm_testMarketplaceConnection=function(t,i,e){mpIDStr=e?"&mpID="+e:"",i=i||"",params={mpID:e},$.getJSON(CCM_TOOLS_PATH+"/marketplace/connect",params,function(e){if(!e.isConnected)return $.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/frame?task="+i+mpIDStr+"&ccm_token="+e.token,width:"90%",modal:!1,height:"70%"}),!1;t()})},ccm_openAddonLauncher=function(){jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader(),ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/add-ons",width:"905",modal:!1,height:"410"})},"open_addon_launcher")},ccm_setupMarketplaceDialogForm=function(){$(".ccm-pane-dialog-pagination").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]),$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove(),$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))}),$(".ccm-pane-dialog-pagination a").click(function(){return jQuery.fn.dialog.showLoader(),$("#ccm-marketplace-browser-form").closest(".ui-dialog-content").load($(this).attr("href"),function(){jQuery.fn.dialog.hideLoader()}),!1}),ccm_marketplaceBrowserInit(),$("#ccm-marketplace-browser-form").ajaxForm({beforeSubmit:function(){jQuery.fn.dialog.showLoader()},success:function(e){jQuery.fn.dialog.hideLoader(),$("#ccm-marketplace-browser-form").closest(".ui-dialog-content").html(e)}})},ccm_marketplaceBrowserInit=function(){$(".ccm-marketplace-item").click(function(){ccm_getMarketplaceItemDetails($(this).attr("mpID"))}),$(".ccm-marketplace-item-thumbnail").mouseover(function(){var e=$(this).parent().find("div.ccm-marketplace-results-image-hover").clone().addClass("ccm-marketplace-results-image-hover-displayed").appendTo(document.body),t=$(this).offset().top,i=$(this).offset().left;i+=60,e.css("top",t).css("left",i),e.show()}),$(".ccm-marketplace-item-thumbnail").mouseout(function(){$(".ccm-marketplace-results-image-hover-displayed").hide().remove()})},ccm_getMarketplaceItemDetails=function(e){jQuery.fn.dialog.showLoader(),$("#ccm-intelligent-search-results").hide(),ccm_testMarketplaceConnection(function(){$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/details?mpID="+e,width:820,appendButtons:!0,modal:!1,height:640})},"get_item_details",e)},ccm_getMarketplaceItem=function(e){var t=e.mpID,i=e.closeTop,c=e.token;this.onComplete=function(){},e.onComplete&&(ccm_getMarketplaceItem.onComplete=e.onComplete),i&&jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.showLoader(),params={mpID:t},$.getJSON(CCM_TOOLS_PATH+"/marketplace/connect",params,function(e){jQuery.fn.dialog.hideLoader(),e.isConnected?e.purchaseRequired?$.fn.dialog.open({title:ccmi18n.communityCheckout,iframe:!0,href:CCM_TOOLS_PATH+"/marketplace/checkout?mpID="+t,width:"560px",modal:!1,height:"400px"}):$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/download?install=1&mpID="+t+"&ccm_token="+e.token,width:500,appendButtons:!0,modal:!1,height:400}):$.fn.dialog.open({title:ccmi18n.community,href:CCM_TOOLS_PATH+"/marketplace/frame?task=get&mpID="+t+"&ccm_token="+c,width:"90%",modal:!1,height:"70%"})})},new Array),tr_activeNode=(ccm_setupAdvancedSearchFields=function(e){ccm_totalAdvancedSearchFields=$(".ccm-search-request-field-set").length,$("#ccm-"+e+"-search-add-option").unbind(),$("#ccm-"+e+"-search-add-option").click(function(){ccm_totalAdvancedSearchFields++,0<$("#ccm-search-fields-wrapper").length?$("#ccm-search-fields-wrapper").append('<div class="ccm-search-field" id="ccm-'+e+"-search-field-set"+ccm_totalAdvancedSearchFields+'">'+$("#ccm-search-field-base").html()+"</div>"):$("#ccm-"+e+"-search-advanced-fields").append('<tr class="ccm-search-field" id="ccm-'+e+"-search-field-set"+ccm_totalAdvancedSearchFields+'">'+$("#ccm-search-field-base").html()+"</tr>"),ccm_activateAdvancedSearchFields(e,ccm_totalAdvancedSearchFields)});var t=1;$(".ccm-search-request-field-set").each(function(){ccm_activateAdvancedSearchFields(e,t),t++})},ccm_setupAdvancedSearch=function(t){ccm_setupAdvancedSearchFields(t),$("#ccm-"+t+"-advanced-search").ajaxForm({beforeSubmit:function(){ccm_deactivateSearchResults(t)},success:function(e){ccm_parseAdvancedSearchResponse(e,t)}}),ccm_setupInPagePaginationAndSorting(t),ccm_setupSortableColumnSelection(t)},ccm_parseAdvancedSearchResponse=function(e,t){var i=$("#ccm-"+t+"-search-results");(i=0!=i.length&&null!=t?i:$("#ccm-search-results")).html(e),ccm_activateSearchResults(t)},ccm_deactivateSearchResults=function(e){var t=$("#ccm-"+e+"-search-fields-submit");(t=0!=t.length&&null!=e?t:$("#ccm-search-fields-submit")).attr("disabled",!0),(t=0!=(t=$("#ccm-"+e+"-search-results table.ccm-results-list")).length&&null!=e?t:$("#ccm-search-results")).css("opacity",.4),jQuery.fn.dialog.showLoader()},ccm_activateSearchResults=function(e){0==$(".ui-dialog-content").length?window.scrollTo(0,0):$(".ui-dialog-content").each(function(e){$(this).get(0).scrollTop=0}),$(".dialog-launch").dialog();var t=$("#ccm-"+e+"-search-results table.ccm-results-list");(t=0!=t.length&&null!=e?t:$("#ccm-search-results")).css("opacity",1),jQuery.fn.dialog.hideLoader(),(t=0!=(t=$("#ccm-"+e+"-search-fields-submit")).length&&null!=e?t:$("#ccm-search-fields-submit")).attr("disabled",!1),ccm_setupInPagePaginationAndSorting(e),ccm_setupSortableColumnSelection(e),"function"==typeof ccm_searchActivatePostFunction[e]&&ccm_searchActivatePostFunction[e]()},ccm_setupInPagePaginationAndSorting=function(t){$(".ccm-results-list th a").click(function(){ccm_deactivateSearchResults(t);var e=$("#ccm-"+t+"-search-results");return(e=0==e.length?$("#ccm-search-results"):e).load($(this).attr("href"),!1,function(){ccm_activateSearchResults(t)}),!1}),$("div.ccm-pagination a").click(function(){var e;return $(this).parent().hasClass("disabled")||(ccm_deactivateSearchResults(t),(e=0==(e=$("#ccm-"+t+"-search-results")).length?$("#ccm-search-results"):e).load($(this).attr("href"),!1,function(){ccm_activateSearchResults(t),$("div.ccm-dialog-content").attr("scrollTop",0)})),!1}),$(".ccm-pane-dialog-pagination").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]),$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove(),$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))})},ccm_setupSortableColumnSelection=function(e){$("#ccm-list-view-customize").unbind(),$("#ccm-list-view-customize").click(function(){return jQuery.fn.dialog.open({width:550,height:350,appendButtons:!0,modal:!1,href:$(this).attr("href"),title:ccmi18n.customizeSearch}),!1})},ccm_checkSelectedAdvancedSearchField=function(e,t){$("#ccm-"+e+"-search-field-set"+t+" .ccm-search-option-type-date_time input").each(function(){$(this).attr("id",$(this).attr("id")+t)}),$("#ccm-"+e+"-search-field-set"+t+" .ccm-search-option-type-date_time input").datepicker({showAnim:"fadeIn"}),$("#ccm-"+e+"-search-field-set"+t+" .ccm-search-option-type-rating input").rating()},ccm_activateAdvancedSearchFields=function(t,i){var e=$("#ccm-"+t+"-search-field-set"+i+" select:first");e.unbind(),e.change(function(){var e=$(this).find(":selected").val(),e=($(this).parent().parent().find("input.ccm-"+t+"-selected-field").val(e),$("#ccm-"+t+"-search-field-base-elements span[search-field="+e+"]"));$("#ccm-"+t+"-search-field-set"+i+" .ccm-selected-field-content").html(""),e.clone().appendTo("#ccm-"+t+"-search-field-set"+i+" .ccm-selected-field-content"),$("#ccm-"+t+"-search-field-set"+i+" .ccm-selected-field-content .ccm-search-option").show(),ccm_checkSelectedAdvancedSearchField(t,i)}),$("#ccm-"+t+"-search-field-set"+i+" .ccm-search-remove-option").unbind(),$("#ccm-"+t+"-search-field-set"+i+" .ccm-search-remove-option").click(function(){$(this).parents("div.ccm-search-field").remove(),$(this).parents("tr.ccm-search-field").remove()}),ccm_checkSelectedAdvancedSearchField(t,i)},ccm_activateEditablePropertiesGrid=function(){$("tr.ccm-attribute-editable-field").each(function(){var t=$(this);$(this).find("a").click(function(){t.find(".ccm-attribute-editable-field-text").hide(),t.find(".ccm-attribute-editable-field-clear-button").hide(),t.find(".ccm-attribute-editable-field-form").show(),t.find(".ccm-attribute-editable-field-save-button").show()}),t.find("form").submit(function(){return!1}),t.find(".ccm-attribute-editable-field-save-button").parent().click(function(){var e=t.find("form input[name=task]");"clear_extended_attribute"==e.val()&&(e.val(e.attr("data-original-task")),e.attr("data-original-task","")),ccm_submitEditablePropertiesGrid(t)}),t.find(".ccm-attribute-editable-field-clear-button").parent().unbind(),t.find(".ccm-attribute-editable-field-clear-button").parent().click(function(){var e=t.find("form input[name=task]");return e.attr("data-original-task",e.val()),e.val("clear_extended_attribute"),ccm_submitEditablePropertiesGrid(t),!1})})},ccm_submitEditablePropertiesGrid=function(t){t.find(".ccm-attribute-editable-field-save-button").hide(),t.find(".ccm-attribute-editable-field-clear-button").hide(),t.find(".ccm-attribute-editable-field-loading").show();try{tinyMCE.triggerSave(!0,!0)}catch(e){}t.find("form").ajaxSubmit(function(e){t.find(".ccm-attribute-editable-field-loading").hide(),t.find(".ccm-attribute-editable-field-save-button").show(),t.find(".ccm-attribute-editable-field-text").html(e),t.find(".ccm-attribute-editable-field-form").hide(),t.find(".ccm-attribute-editable-field-save-button").hide(),t.find(".ccm-attribute-editable-field-text").show(),t.find(".ccm-attribute-editable-field-clear-button").show(),t.find("td").show("highlight",{color:"#FFF9BB"})})},!1),tr_doAnim,tr_parseSubnodes=(void 0===tr_doAnim&&(tr_doAnim=!1),!0),tr_reorderMode=!1,tr_moveCopyMode=!1,SITEMAP_LAST_DIALOGUE_URL=(showPageMenu=function(e,t){ccm_hideMenus(),t.stopPropagation();var i,c,a=$("#ccm-page-menu"+e.cID);a.get(0)?a=$("#ccm-page-menu"+e.cID):((el=document.createElement("DIV")).id="ccm-page-menu"+e.cID,el.className="ccm-menu ccm-ui",el.style.display="block",el.style.visibility="hidden",document.body.appendChild(el),(a=$("#ccm-page-menu"+e.cID)).css("position","absolute"),i='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">',i+="<ul>",e.isTrash?i+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" onclick="ccm_sitemapDeleteForever('+e.instance_id+","+e.cID+', true)" href="javascript:void(0)">'+ccmi18n_sitemap.emptyTrash+"</a></li>":e.inTrash?i=(i=i+('<li><a class="ccm-menu-icon ccm-icon-search-pages" onclick="ccm_previewInternalTheme('+e.cID+", false, '"+ccmi18n_sitemap.previewPage+'\')" href="javascript:void(0)">'+ccmi18n_sitemap.previewPage)+'</a></li><li class="ccm-menu-separator"></li>')+'<li><a class="ccm-menu-icon ccm-icon-delete-menu" onclick="ccm_sitemapDeleteForever('+e.instance_id+","+e.cID+', false)" href="javascript:void(0)">'+ccmi18n_sitemap.deletePageForever+"</a></li>":"LINK"==e.cAlias||"POINTER"==e.cAlias?(i+='<li><a class="ccm-menu-icon ccm-icon-visit" id="menuVisit'+e.cID+'" href="javascript:void(0)" onclick="window.location.href=\''+CCM_DISPATCHER_FILENAME+"?cID="+e.cID+"'\">"+ccmi18n_sitemap.visitExternalLink+"</a></li>","LINK"==e.cAlias&&e.canEditProperties&&(i+='<li><a class="ccm-menu-icon ccm-icon-edit-external-link" dialog-width="350" dialog-height="170" dialog-title="'+ccmi18n_sitemap.editExternalLink+'" dialog-modal="false" dialog-append-buttons="true" id="menuLink'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+'&ctask=edit_external">'+ccmi18n_sitemap.editExternalLink+"</a></li>"),e.canDelete&&(i+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" dialog-append-buttons="true" id="menuDelete'+e.cID+'" dialog-width="360" dialog-height="150" dialog-modal="false" dialog-append-buttons="true" dialog-title="'+ccmi18n_sitemap.deleteExternalLink+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+"&display_mode="+e.display_mode+"&instance_id="+e.instance_id+"&select_mode="+e.select_mode+'&ctask=delete_external">'+ccmi18n_sitemap.deleteExternalLink+"</a></li>")):(i+='<li><a class="ccm-menu-icon ccm-icon-visit" id="menuVisit'+e.cID+'" href="'+CCM_DISPATCHER_FILENAME+"?cID="+e.cID+'">'+ccmi18n_sitemap.visitPage+"</a></li>",e.canCompose&&(i+='<li><a class="ccm-menu-icon ccm-icon-edit-in-composer-menu" id="menuComposer'+e.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/composer/write/-/edit/"+e.cID+'">'+ccmi18n_sitemap.editInComposer+"</a></li>"),(e.canEditProperties||e.canEditSpeedSettings||e.canEditPermissions||e.canEditDesign||e.canViewVersions||e.canDelete)&&(i+='<li class="ccm-menu-separator"></li>'),e.canEditProperties&&(i+='<li><a class="ccm-menu-icon ccm-icon-properties-menu" dialog-on-close="ccm_sitemapExitEditMode('+e.cID+')" dialog-width="670" dialog-height="360" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.pagePropertiesTitle+'" id="menuProperties'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+'&ctask=edit_metadata">'+ccmi18n_sitemap.pageProperties+"</a></li>"),e.canEditSpeedSettings&&(i+='<li><a class="ccm-menu-icon ccm-icon-speed-settings-menu" dialog-on-close="ccm_sitemapExitEditMode('+e.cID+')" dialog-width="550" dialog-height="280" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.speedSettingsTitle+'" id="menuSpeedSettings'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+'&ctask=edit_speed_settings">'+ccmi18n_sitemap.speedSettings+"</a></li>"),e.canEditPermissions&&(i+='<li><a class="ccm-menu-icon ccm-icon-permissions-menu" dialog-on-close="ccm_sitemapExitEditMode('+e.cID+')" dialog-width="420" dialog-height="630" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.setPagePermissions+'" id="menuPermissions'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+'&ctask=edit_permissions">'+ccmi18n_sitemap.setPagePermissions+"</a></li>"),e.canEditDesign&&(i+='<li><a class="ccm-menu-icon ccm-icon-design-menu" dialog-on-close="ccm_sitemapExitEditMode('+e.cID+')" dialog-width="610" dialog-append-buttons="true" dialog-height="405" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.pageDesign+'" id="menuDesign'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+'&ctask=set_theme">'+ccmi18n_sitemap.pageDesign+"</a></li>"),e.canViewVersions&&(i+='<li><a class="ccm-menu-icon ccm-icon-versions-menu" dialog-on-close="ccm_sitemapExitEditMode('+e.cID+')" dialog-width="640" dialog-height="340" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.pageVersions+'" id="menuVersions'+e.cID+'" href="'+CCM_TOOLS_PATH+"/versions.php?rel=SITEMAP&cID="+e.cID+'">'+ccmi18n_sitemap.pageVersions+"</a></li>"),e.canDelete&&(i+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" dialog-on-close="ccm_sitemapExitEditMode('+e.cID+')" dialog-append-buttons="true" id="menuDelete'+e.cID+'" dialog-width="360" dialog-height="200" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.deletePage+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+"&display_mode="+e.display_mode+"&instance_id="+e.instance_id+"&select_mode="+e.select_mode+'&ctask=delete">'+ccmi18n_sitemap.deletePage+"</a></li>"),"explore"!=e.display_mode&&"search"!=e.display_mode||(i=(i+='<li class="ccm-menu-separator"></li>')+'<li><a class="ccm-menu-icon ccm-icon-move-copy-menu" dialog-width="90%" dialog-height="70%" dialog-modal="false" dialog-title="'+ccmi18n_sitemap.moveCopyPage+'" id="menuMoveCopy'+e.cID+'" href="'+CCM_TOOLS_PATH+"/sitemap_search_selector?sitemap_select_mode=move_copy_delete&cID="+e.cID+'" id="menuMoveCopy'+e.cID+'">'+ccmi18n_sitemap.moveCopyPage+"</a></li>","explore"==e.display_mode&&(i=(i+='<li><a class="ccm-menu-icon ccm-icon-move-up" id="menuSendToStop'+e.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore?cNodeID="+e.cID+'&task=send_to_top">'+ccmi18n_sitemap.sendToTop+"</a></li>")+'<li><a class="ccm-menu-icon ccm-icon-move-down" id="menuSendToBottom'+e.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore?cNodeID="+e.cID+'&task=send_to_bottom">'+ccmi18n_sitemap.sendToBottom+"</a></li>")),0<e.cNumChildren&&(i+='<li class="ccm-menu-separator"></li>',c=CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/search/?selectedSearchField[]=parent&cParentAll=1&cParentIDSearchField="+e.cID,"full"!=e.display_mode&&""!=e.display_mode&&"explore"!=e.display_mode||(i+='<li><a class="ccm-menu-icon ccm-icon-search-pages" id="menuSearch'+e.cID+'" href="'+c+'">'+ccmi18n_sitemap.searchPages+"</a></li>"),"explore"!=e.display_mode)&&(i+='<li><a class="ccm-menu-icon ccm-icon-flat-view" id="menuExplore'+e.cID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore/-/"+e.cID+'">'+ccmi18n_sitemap.explorePages+"</a></li>"),(e.canAddSubpages||e.canAddExternalLinks)&&(i+='<li class="ccm-menu-separator"></li>'),e.canAddSubpages&&(i+='<li><a class="ccm-menu-icon ccm-icon-add-page-menu" dialog-append-buttons="true" dialog-width="645" dialog-modal="false" dialog-height="345" dialog-title="'+ccmi18n_sitemap.addPage+'" id="menuSubPage'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&mode="+e.display_mode+"&cID="+e.cID+'&ctask=add">'+ccmi18n_sitemap.addPage+"</a></li>"),"search"!=e.display_mode&&e.canAddExternalLinks&&(i+='<li><a class="ccm-menu-icon ccm-icon-add-external-link-menu" dialog-width="350" dialog-modal="false" dialog-height="170" dialog-title="'+ccmi18n_sitemap.addExternalLink+'" dialog-modal="false" dialog-append-buttons="true" id="menuLink'+e.cID+'" href="'+CCM_TOOLS_PATH+"/edit_collection_popup.php?rel=SITEMAP&cID="+e.cID+'&ctask=add_external">'+ccmi18n_sitemap.addExternalLink+"</a></li>")),a.append(i=i+"</ul>"+"</div></div></div>"),$(a).find("a").bind("click.hide-menu",function(e){ccm_hideMenus()}),$("#menuProperties"+e.cID).dialog(),$("#menuSpeedSettings"+e.cID).dialog(),$("#menuSubPage"+e.cID).dialog(),$("#menuDesign"+e.cID).dialog(),$("#menuLink"+e.cID).dialog(),$("#menuVersions"+e.cID).dialog(),$("#menuPermissions"+e.cID).dialog(),$("#menuMoveCopy"+e.cID).dialog(),$("#menuDelete"+e.cID).dialog()),ccm_fadeInMenu(a,t)},hideBranch=function(e){$("#tree-node"+e).hide(),$("#tree-dz"+e).hide()},cancelReorder=function(){tr_reorderMode&&(tr_reorderMode=!1,$("li.tree-node[draggable=true]").draggable("destroy"),tr_moveCopyMode||hideSitemapMessage())},ccm_sitemapExitEditMode=function(e){$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_check_in?cID="+e+"&ccm_token="+CCM_SECURITY_TOKEN)},searchSubPages=function(e){$("#ccm-tree-search-trigger"+e).hide(),ccm_animEffects?$("#ccm-tree-search"+e).fadeIn(200,function(){$("#ccm-tree-search"+e+" input").get(0).focus()}):($("#ccm-tree-search"+e).show(),$("#ccm-tree-search"+e+" input").get(0).focus())},activateReorder=function(){tr_reorderMode=!0,$("li.tree-node[draggable=true]").draggable({handle:"img.handle",opacity:.5,revert:!1,helper:"clone",start:function(){$(document.body).css("overflowX","hidden")},stop:function(){$(document.body).css("overflowX","auto")}}),fixResortingDroppables()},deleteBranchFade=function(e){ccm_animEffects?($("#tree-node"+e).fadeOut(300,function(){$("#tree-node"+e).remove()}),$("#tree-dz"+e).fadeOut(300,function(){$("#tree-dz"+e).remove()})):deleteBranchDirect(e)},deleteBranchDirect=function(e){$("#tree-node"+e).remove(),$("#tree-dz"+e).remove()},showBranch=function(e){$("#tree-node"+e);$("#tree-node"+e).show(),$("#tree-dz"+e).show()},rescanDisplayOrder=function(t){setLoading(t);var e="?foo=1",c=$("#tree-root"+t).children("li.tree-node");for(i=0;i<c.length;i++)$(c[i]).hasClass("ui-draggable-dragging")||(e+="&cID[]="+$(c[i]).attr("id").substring(9));$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_update.php",e,function(e){ccm_parseJSON(e,function(){}),removeLoading(t)})},""),ccm_sitemap_html="";function fixResortingDroppables(){if(0==tr_reorderMode)return!1;for(var e=$(".dropzone"),t=0;t<e.length;t++){var i=$(e[t]).attr("id").substr(7);addResortDroppable(i=0<i.indexOf("-sub")?i.substr(0,i.length-4):i)}}function addResortDroppable(e){$(".tree-branch"+e).length<=1||$("div.tree-dz"+e).droppable({accept:".tree-branch"+e,activeClass:"dropzone-ready",hoverClass:"dropzone-active",drop:function(e,t){var t=t.draggable,i=($(t).insertAfter(this),$(t).attr("id").substring(9));$("#tree-dz"+i).insertAfter($(t)),rescanDisplayOrder($(this).attr("tree-parent"))}})}parseSitemapResponse=function(e,t,i,c,a){c=$("ul[tree-root-node-id="+c+"][sitemap-instance-id="+e+"]");c.html(a),c.slideDown(150,"easeOutExpo")},selectMoveCopyTarget=function(e,t,i,c,a){a=a||CCM_CID;var s=ccmi18n_sitemap.moveCopyPage,e=CCM_TOOLS_PATH+"/dashboard/sitemap_drag_request.php?instance_id="+e+"&display_mode="+t+"&select_mode="+i+"&origCID="+a+"&destCID="+c,t=350,i=350;try{if("<none>"==CCM_NODE_ACTION)return""!=CCM_TARGET_ID&&$("#"+CCM_TARGET_ID).val(c),void $.fn.dialog.closeTop();""!=CCM_NODE_ACTION&&(e=CCM_NODE_ACTION+"?destCID="+c),""!=CCM_DIALOG_TITLE&&(s=CCM_DIALOG_TITLE),""!=CCM_DIALOG_HEIGHT&&(t=CCM_DIALOG_HEIGHT),""!=CCM_DIALOG_WIDTH&&(i=CCM_DIALOG_WIDTH)}catch(e){}$.fn.dialog.open({title:s,href:e,width:i,appendButtons:!0,modal:!1,height:t,onClose:function(){"undefined"!=typeof CCM_TARGET_ID&&""!=CCM_TARGET_ID&&$("#"+CCM_TARGET_ID).val(c),1==tr_moveCopyMode&&deactivateMoveCopy()}})},selectLabel=function(e,node){var cNumChildren=node.attr("tree-node-children"),destCID,origCID,callback;"move_copy_delete"==node.attr("sitemap-select-mode")||1==tr_moveCopyMode?(destCID=node.attr("id").substring(10),origCID=node.attr("selected-page-id"),selectMoveCopyTarget(node.attr("sitemap-instance-id"),node.attr("sitemap-display-mode"),node.attr("sitemap-select-mode"),destCID,origCID)):"select_page"==node.attr("sitemap-select-mode")?(callback=node.parents("[sitemap-wrapper=1]").attr("sitemap-select-callback"),null!=callback&&""!=callback&&void 0!==callback||(callback="ccm_selectSitemapNode"),eval(callback+"(node.attr('id').substring(10), unescape(node.attr('tree-node-title')));"),jQuery.fn.dialog.closeTop()):(node.addClass("tree-label-selected"),0!=tr_activeNode&&tr_activeNode.attr("id")!=node.attr("id")&&tr_activeNode.removeClass("tree-label-selected"),params={cID:node.attr("id").substring(10),display_mode:node.attr("sitemap-display-mode"),isTrash:node.attr("tree-node-istrash"),inTrash:node.attr("tree-node-intrash"),select_mode:node.attr("sitemap-select-mode"),instance_id:node.attr("sitemap-instance-id"),canCompose:node.attr("tree-node-cancompose"),canEditProperties:node.attr("tree-node-can-edit-properties"),canEditSpeedSettings:node.attr("tree-node-can-edit-speed-settings"),canEditPermissions:node.attr("tree-node-can-edit-permissions"),canEditDesign:node.attr("tree-node-can-edit-design"),canViewVersions:node.attr("tree-node-can-view-versions"),canDelete:node.attr("tree-node-can-delete"),canAddSubpages:node.attr("tree-node-can-add-subpages"),canAddExternalLinks:node.attr("tree-node-can-add-external-links"),cNumChildren:node.attr("tree-node-children"),cAlias:node.attr("tree-node-alias")},showPageMenu(params,e),tr_activeNode=node)},ccmSitemapHighlightPageLabel=function(e,t){var i=$("#tree-label"+e+" > span");0==i.length?0<(i=$("tr.ccm-list-record[cID="+e+"]")).length&&$("#ccm-page-advanced-search").submit():null!=t&&i.html(t),i.show("highlight")},activateLabels=function(a,i,c){var e=$("ul[sitemap-instance-id="+a+"]");e.find("div.tree-label span").unbind(),e.find("div.tree-label span").click(function(e){selectLabel(e,$(this).parent())}),e.find("ul[tree-root-state=closed]").each(function(){var e=$(this),t=$(this).attr("tree-root-node-id");0<$(this).find("li").length&&(e.attr("tree-root-state","open"),$("#tree-collapse"+t).attr("src",CCM_IMAGE_PATH+"/dashboard/minus.jpg"))}),"select_page"!=c&&"move_copy_delete"!=c||e.find("li.ccm-sitemap-explore-paging a").each(function(){$(this).click(function(){var t=$(this).parentsUntil("ul").parent().parentsUntil("ul").parent().attr("tree-root-node-id");return jQuery.fn.dialog.showLoader(),$.get($(this).attr("href"),function(e){parseSitemapResponse(a,i,c,t,e),activateLabels(a,i,c),jQuery.fn.dialog.hideLoader()}),!1})}),"explore"!=i&&"full"!=i||c||e.find("img.handle").addClass("moveable"),"full"!=i||c||(e.find("div.tree-label").droppable({accept:".tree-node",hoverClass:"on-drop",drop:function(e,t){var t=t.draggable,i=$(this).attr("id").substring(10),c=$(t).attr("id").substring(9);return i!=c&&(t=CCM_TOOLS_PATH+"/dashboard/sitemap_drag_request.php?instance_id="+a+"&origCID="+c+"&destCID="+i,SITEMAP_LAST_DIALOGUE_URL!=t)&&(SITEMAP_LAST_DIALOGUE_URL=t,void $.fn.dialog.open({title:ccmi18n_sitemap.moveCopyPage,href:t,width:350,modal:!1,height:350,appendButtons:!0,onClose:function(){showBranch(c),SITEMAP_LAST_DIALOGUE_URL=""}}))}}),e.find("li.tree-node[draggable=true]").draggable({handle:"img.handle",opacity:.5,revert:!1,helper:"clone",start:function(){$(document.body).css("overflowX","hidden")},stop:function(){$(document.body).css("overflowX","auto")}}))},ccm_triggerProgressiveOperation=function(c,a,t,s,n){jQuery.fn.dialog.showLoader(),$("#ccm-dialog-progress-bar").remove(),$.ajax({url:c,type:"POST",data:a,success:function(e){jQuery.fn.dialog.hideLoader(),$('<div id="ccm-dialog-progress-bar" />').appendTo(document.body).html(e).jqdialog({autoOpen:!1,height:200,width:400,modal:!0,title:t,closeOnEscape:!1,open:function(e,t){$(".ui-dialog-titlebar-close",this.parentNode).hide();var i=$("#ccm-progressive-operation-progress-bar").attr("data-total-items");a.push({name:"process",value:"1"}),ccm_doProgressiveOperation(c,a,i,s,n)}}),$("#ccm-dialog-progress-bar").jqdialog("open")}})},ccm_doProgressiveOperation=function(c,a,s,n,o){$.ajax({url:c,dataType:"json",type:"POST",data:a,error:function(e,t,i){t="timeout"===t?ccmi18n.requestTimeout:e.responseText,$("#ccm-dialog-progress-bar").dialog("option","height",200),$("#ccm-dialog-progress-bar").dialog("option","closeOnEscape",!0),$("#ccm-progressive-operation-progress-bar").html('<div class="alert alert-error">'+t+"</div>"),$(".ui-dialog-titlebar-close").show()},success:function(e){var t,i;e.error?(t=e.message,$("#ccm-dialog-progress-bar").dialog("option","height",200),$("#ccm-dialog-progress-bar").dialog("option","closeOnEscape",!0),$("#ccm-progressive-operation-progress-bar").html('<div class="alert alert-error">'+t+"</div>"),$(".ui-dialog-titlebar-close").show(),"function"==typeof o&&o(e)):(t=e.totalItems,i=Math.round((s-t)/s*100),$("#ccm-progressive-operation-status").html(1),0<s-t&&$("#ccm-progressive-operation-status").html(s-t),$("#ccm-progressive-operation-progress-bar div.bar").width(i+"%"),0<t?setTimeout(function(){ccm_doProgressiveOperation(c,a,s,n,o)},250):setTimeout(function(){$("#ccm-progressive-operation-progress-bar div.bar").width("0%"),$("#ccm-dialog-progress-bar").dialog("close"),"function"==typeof n&&n(e)},1e3))}})},ccm_refreshCopyOperations=function(){var e=ccmi18n_sitemap.copyProgressTitle;ccm_triggerProgressiveOperation(CCM_TOOLS_PATH+"/dashboard/sitemap_copy_all",[],e,function(){$(".ui-dialog-content").dialog("close"),window.location.reload()})},moveCopyAliasNode=function(t){var i=$("#origCID").val(),c=$("#destParentID").val(),a=$("#destCID").val(),s=$("input[name=ctask]:checked").val(),n=$("input[name=instance_id]").val(),o=$("input[name=display_mode]").val(),l=$("input[name=select_mode]").val(),e=$("input[name=copyAll]:checked").val(),r=$("input[name=saveOldPagePath]:checked").val();params={origCID:i,destCID:a,ctask:s,ccm_token:CCM_SECURITY_TOKEN,copyAll:e,saveOldPagePath:r},1==e?(r=ccmi18n_sitemap.copyProgressTitle,ccm_triggerProgressiveOperation(CCM_TOOLS_PATH+"/dashboard/sitemap_copy_all",[{name:"origCID",value:i},{name:"destCID",value:a}],r,function(){$(".ui-dialog-content").dialog("close"),openSub(n,c,o,l,function(){openSub(n,a,o,l)})})):(jQuery.fn.dialog.showLoader(),$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_drag_request.php",params,function(e){ccm_parseJSON(e,function(){if(jQuery.fn.dialog.closeAll(),jQuery.fn.dialog.hideLoader(),ccmAlert.hud(e.message,2e3),1==t){if("undefined"==typeof CCM_LAUNCHER_SITEMAP)return setTimeout(function(){window.location.href=CCM_DISPATCHER_FILENAME+"?cID="+e.cID},2e3),!1;if("explore"==CCM_LAUNCHER_SITEMAP)return window.location.href=CCM_DISPATCHER_FILENAME+"/dashboard/sitemap/explore/-/"+a,!1;"search"==CCM_LAUNCHER_SITEMAP&&(ccm_deactivateSearchResults(CCM_SEARCH_INSTANCE_ID),$("#ccm-"+CCM_SEARCH_INSTANCE_ID+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,CCM_SEARCH_INSTANCE_ID)}))}switch(s){case"COPY":case"ALIAS":showBranch(i);break;case"MOVE":deleteBranchDirect(i)}openSub(n,c,o,l,function(){openSub(n,a,o,l)}),jQuery.fn.dialog.closeTop(),jQuery.fn.dialog.closeTop()})}))},toggleSub=function(e,t,i,c){ccm_hideMenus(),("closed"==$("ul[tree-root-node-id="+t+"][sitemap-instance-id="+e+"]").attr("tree-root-state")?openSub:closeSub)(e,t,i,c)},ccm_sitemapDeleteForever=function(t,i,c){var e=c?ccmi18n_sitemap.emptyTrash:ccmi18n_sitemap.deletePages;ccm_triggerProgressiveOperation(CCM_TOOLS_PATH+"/dashboard/sitemap_delete_forever",[{name:"cID",value:i}],e,function(){var e;c?(closeSub(t,i,"full",""),(e=$("ul[tree-root-node-id="+i+"]").parent()).find("img.tree-plus").remove(),e.find("span.ccm-sitemap-num-subpages").remove()):(deleteBranchFade(i),ccmAlert.hud(ccmi18n_sitemap.deletePageSuccessMsg,2e3))})},setLoading=function(e){e=$("#tree-node"+e);e.removeClass("tree-node-"+e.attr("tree-node-type")),e.addClass("tree-node-loading")},removeLoading=function(e){e=$("#tree-node"+e);e.removeClass("tree-node-loading"),e.addClass("tree-node-"+e.attr("tree-node-type"))},openSub=function(t,i,e,c,a){setLoading(i);var s=$("#tree-root"+i);cancelReorder(),ccm_sitemap_html="",$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?instance_id="+t+"&node="+i+"&display_mode="+e+"&select_mode="+c+"&selectedPageID="+s.attr("selected-page-id"),function(e){parseSitemapResponse(t,"full",c,i,e),activateLabels(t,"full",c),"move_copy_delete"!=c&&"select_page"!=c&&activateReorder(),setTimeout(function(){removeLoading(i),null!=a&&a()},200)})},closeSub=function(e,t,i,c){var a=$("ul[tree-root-node-id="+t+"][sitemap-instance-id="+e+"]");tr_doAnim?(setLoading(t),a.slideUp(150,"easeOutExpo",function(){removeLoading(t),a.attr("tree-root-state","closed"),a.html(""),$("#ccm-tree-search"+t).hide(),$("#tree-collapse"+t).attr("src",CCM_IMAGE_PATH+"/dashboard/plus.jpg"),a.removeClass("ccm-sitemap-search-results")})):(a.hide(),a.attr("tree-root-state","closed"),a.removeClass("ccm-sitemap-search-results"),$("#ccm-tree-search"+t).hide(),$("#tree-collapse"+t).attr("src",CCM_IMAGE_PATH+"/dashboard/plus.jpg")),1==tr_moveCopyMode&&$("#ccm-tree-search-trigger"+cID).show(),$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?instance_id="+e+"&select_mode="+c+"&display_mode="+i+"&node="+t+"&ctask=close-node")},toggleMove=function(){$("#copyThisPage").get(0)&&($("#copyThisPage").get(0).disabled=!0,$("#copyChildren").get(0).disabled=!0,$("#saveOldPagePath").attr("disabled",!1))},toggleAlias=function(){$("#copyThisPage").get(0)&&($("#copyThisPage").get(0).disabled=!0,$("#copyChildren").get(0).disabled=!0,$("#saveOldPagePath").attr("checked",!1),$("#saveOldPagePath").attr("disabled","disabled"))},toggleCopy=function(){$("#copyThisPage").get(0)&&($("#copyThisPage").get(0).disabled=!1,$("#copyThisPage").get(0).checked=!0,$("#copyChildren").get(0).disabled=!1,$("#saveOldPagePath").attr("checked",!1),$("#saveOldPagePath").attr("disabled","disabled"))},showSitemapMessage=function(e){$("#ccm-sitemap-message").addClass("message"),$("#ccm-sitemap-message").html(e),$("#ccm-sitemap-message").fadeIn(200)},hideSitemapMessage=function(){$("#ccm-sitemap-message").hide()},ccmSitemapExploreNode=function(t,e,i,c,a){jQuery.fn.dialog.showLoader(),$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php",{instance_id:t,display_mode:e,select_mode:i,node:c,selectedPageID:a},function(e){parseSitemapResponse(t,"explore",i,0,e),activateLabels(t,"explore",i),jQuery.fn.dialog.hideLoader(),ccm_sitemap_html=""})},ccmSitemapLoad=function(a,e,t,c,s,n){"move_copy_delete"==t||"select_page"==t?ccmSitemapExploreNode(a,e,t,c,s):"full"==e?(activateLabels(a,e,t),"move_copy_delete"!=t&&"select_page"!=t&&activateReorder(),tr_parseSubnodes=!(tr_doAnim=!0),ccm_sitemap_html=""):("move_copy_delete"!=t&&"select_page"!=t&&$("ul[sitemap-instance-id="+a+"]").sortable({cursor:"move",items:"li[draggable=true]",opacity:.5,stop:function(e){var t=$("ul[sitemap-instance-id="+a+"]").sortable("toArray"),c="";for(i=0;i<t.length;i++)""!=t[i]&&(c+="&cID[]="+t[i].substring(9));$.getJSON(CCM_TOOLS_PATH+"/dashboard/sitemap_update.php",c,function(e){ccm_parseJSON(e,function(){})})}}),activateLabels(a,e,t)),n&&n()},ccm_sitemapSetupSearch=function(e){ccm_setupAdvancedSearch(e),ccm_sitemapSetupSearchPages(e),ccm_searchActivatePostFunction[e]=function(){ccm_sitemapSetupSearchPages(e),ccm_sitemapSearchSetupCheckboxes(e)},ccm_sitemapSearchSetupCheckboxes(e)},ccm_sitemapSearchSetupCheckboxes=function(t){$("#ccm-"+t+"-list-cb-all").click(function(e){e.stopPropagation(),1==$(this).prop("checked")?($(".ccm-list-record td.ccm-"+t+"-list-cb input[type=checkbox]").attr("checked",!0),$("#ccm-"+t+"-list-multiple-operations").attr("disabled",!1)):($(".ccm-list-record td.ccm-"+t+"-list-cb input[type=checkbox]").attr("checked",!1),$("#ccm-"+t+"-list-multiple-operations").attr("disabled",!0))}),$("td.ccm-"+t+"-list-cb input[type=checkbox]").click(function(e){e.stopPropagation(),0<$("td.ccm-"+t+"-list-cb input[type=checkbox]:checked").length?$("#ccm-"+t+"-list-multiple-operations").attr("disabled",!1):$("#ccm-"+t+"-list-multiple-operations").attr("disabled",!0)}),$("#ccm-"+t+"-list-multiple-operations").change(function(){var e=$(this).val();switch(cIDstring="",$("td.ccm-"+t+"-list-cb input[type=checkbox]:checked").each(function(){cIDstring=cIDstring+"&cID[]="+$(this).val()}),e){case"delete":jQuery.fn.dialog.open({width:500,height:400,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/delete?"+cIDstring+"&searchInstance="+t,title:ccmi18n_sitemap.deletePages});break;case"design":jQuery.fn.dialog.open({width:610,height:405,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/design?"+cIDstring+"&searchInstance="+t,title:ccmi18n_sitemap.pageDesign});break;case"move_copy":jQuery.fn.dialog.open({width:640,height:340,modal:!1,href:CCM_TOOLS_PATH+"/sitemap_overlay?instance_id="+t+"&select_mode=move_copy_delete&"+cIDstring,title:ccmi18n_sitemap.moveCopyPage});break;case"speed_settings":jQuery.fn.dialog.open({width:610,height:340,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/speed_settings?"+cIDstring,title:ccmi18n_sitemap.speedSettingsTitle});break;case"permissions":jQuery.fn.dialog.open({width:430,height:630,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/permissions?"+cIDstring,title:ccmi18n_sitemap.pagePermissionsTitle});break;case"permissions_add_access":jQuery.fn.dialog.open({width:440,height:200,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/permissions_access?task=add&"+cIDstring,title:ccmi18n_sitemap.pagePermissionsTitle});break;case"permissions_remove_access":jQuery.fn.dialog.open({width:440,height:300,modal:!1,appendButtons:!0,href:CCM_TOOLS_PATH+"/pages/permissions_access?task=remove&"+cIDstring,title:ccmi18n_sitemap.pagePermissionsTitle});break;case"properties":jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/pages/bulk_metadata_update?"+cIDstring,title:ccmi18n_sitemap.pagePropertiesTitle})}$(this).get(0).selectedIndex=0})},ccm_sitemapSetupSearchPages=function(instance_id){$("#ccm-"+instance_id+"-list tr").click(function(e){var node=$(this),callback,destCID,origCID;if(node.hasClass("ccm-results-list-header"))return!1;"select_page"==node.attr("sitemap-select-mode")?(callback=node.attr("sitemap-select-callback"),null!=callback&&""!=callback&&void 0!==callback||(callback="ccm_selectSitemapNode"),eval(callback+"(node.attr('cID'), unescape(node.attr('cName')));"),jQuery.fn.dialog.closeTop()):"move_copy_delete"==node.attr("sitemap-select-mode")?(destCID=node.attr("cID"),origCID=node.attr("selected-page-id"),selectMoveCopyTarget(node.attr("sitemap-instance-id"),node.attr("sitemap-display-mode"),node.attr("sitemap-select-mode"),destCID,origCID)):(params={cID:node.attr("cID"),select_mode:node.attr("sitemap-select-mode"),display_mode:node.attr("sitemap-display-mode"),instance_id:node.attr("sitemap-instance-id"),isTrash:node.attr("tree-node-istrash"),inTrash:node.attr("tree-node-intrash"),canCompose:node.attr("tree-node-cancompose"),canEditProperties:node.attr("tree-node-can-edit-properties"),canEditSpeedSettings:node.attr("tree-node-can-edit-speed-settings"),canEditPermissions:node.attr("tree-node-can-edit-permissions"),canEditDesign:node.attr("tree-node-can-edit-design"),canViewVersions:node.attr("tree-node-can-view-versions"),canDelete:node.attr("tree-node-can-delete"),canAddSubpages:node.attr("tree-node-can-add-subpages"),canAddExternalLinks:node.attr("tree-node-can-add-external-links"),cNumChildren:node.attr("cNumChildren"),cAlias:node.attr("cAlias")},showPageMenu(params,e))})},ccm_sitemapSelectDisplayMode=function(e,t,i,c){var a=$("ul[sitemap-instance-id="+e+"]");a.html(""),a.attr("sitemap-display-mode",t),a.attr("sitemap-select-mode",i),a.attr("sitemap-display-mode",t),a="explore"==t?1:0,ccmSitemapLoad(e,t,i,a,c,function(){"explore"==t?$("div[sitemap-wrapper=1][sitemap-instance-id="+e+"]").addClass("ccm-sitemap-explore"):$("div[sitemap-wrapper=1][sitemap-instance-id="+e+"]").removeClass("ccm-sitemap-explore")}),$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?task=save_sitemap_display_mode&display_mode="+t)},ccm_sitemapDeletePages=function(t){var e=$("#ccm-"+t+"-delete-form").formToArray(!0);ccm_triggerProgressiveOperation(CCM_TOOLS_PATH+"/pages/delete",e,ccmi18n_sitemap.deletePages,function(){var e;$(".ui-dialog-content").dialog("close"),ccm_deactivateSearchResults(t),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)}),isTrash?(closeSub(instance_id,nodeID,"full",""),(e=$("ul[tree-root-node-id="+nodeID+"]").parent()).find("img.tree-plus").remove(),e.find("span.ccm-sitemap-num-subpages").remove()):(deleteBranchFade(nodeID),ccmAlert.hud(ccmi18n_sitemap.deletePageSuccessMsg,2e3))})},ccm_sitemapUpdateDesign=function(t){$("#ccm-"+t+"-design-form").ajaxSubmit(function(e){ccm_parseJSON(e,function(){jQuery.fn.dialog.closeTop(),ccm_deactivateSearchResults(t),$("#ccm-"+t+"-advanced-search").ajaxSubmit(function(e){ccm_parseAdvancedSearchResponse(e,t)})})})},$(function(){$(document).click(function(){ccm_hideMenus(),$("div.tree-label").removeClass("tree-label-selected")}),$("#ccm-show-all-pages-cb").click(function(){var e=1==$(this).get(0).checked?1:0;$.get(CCM_TOOLS_PATH+"/dashboard/sitemap_data.php?show_system="+e,function(e){location.reload()})})}),ccm_statusBar={items:[],addItem:function(e){this.items.push(e)},activate:function(e){if(e=e||"ccm-page-controls-wrapper",0<this.items.length){var t='<div id="ccm-page-status-bar" class="ccm-ui">';for(i=0;i<this.items.length;i++){var c=this.items[i],a="",s=c.getButtons();for(j=0;j<s.length;j++){var n=attribs="",o="",l=(""!=s[j].getInnerButtonLeftHTML()&&(n=s[j].getInnerButtonLeftHTML()+" "),""!=s[j].getInnerButtonRightHTML()&&(o=" "+s[j].getInnerButtonRightHTML()),s[j].getAttributes());for(k in l)attribs+=l[k].key+'="'+l[k].value+'" ';""!=s[j].getURL()?a+='<a href="'+s[j].getURL()+'" '+attribs+' class="btn btn-small '+s[j].getCSSClass()+'">'+n+s[j].getLabel()+o+"</a>":a+='<button type="submit" '+attribs+' name="action_'+s[j].getAction()+'" class="btn-small btn '+s[j].getCSSClass()+'">'+n+s[j].getLabel()+o+"</button>"}t+='<form method="post" action="'+c.getAction()+'" id="ccm-status-bar-form-'+i+'" '+(c.useAjaxForm?'class="ccm-status-bar-ajax-form"':"")+'><div class="alert-message alert '+c.getCSSClass()+'"><button type="button" class="close" data-dismiss="alert">×</button><span>'+c.getDescription()+'</span> <div class="ccm-page-status-bar-buttons">'+a+"</div></div></form>"}t+="</div>",$("#"+e).append(t),$("#ccm-page-status-bar .dialog-launch").dialog(),$("#ccm-page-status-bar .alert").bind("closed",function(){$(this).remove(),0==$("#ccm-page-status-bar .alert:visible").length&&$("#ccm-page-status-bar").remove()}),$("#ccm-page-status-bar .ccm-status-bar-ajax-form").ajaxForm({dataType:"json",beforeSubmit:function(){jQuery.fn.dialog.showLoader()},success:function(e){e.redirect&&(window.location.href=e.redirect)}})}}},ccm_statusBarItem=function(){this.css="",this.description="",this.buttons=[],this.action="",this.useAjaxForm=!1,this.setCSSClass=function(e){this.css=e},this.enableAjaxForm=function(){this.useAjaxForm=!0},this.setDescription=function(e){this.description=e},this.getCSSClass=function(){return this.css},this.getDescription=function(){return this.description},this.addButton=function(e){this.buttons.push(e)},this.getButtons=function(){return this.buttons},this.setAction=function(e){this.action=e},this.getAction=function(){return this.action}},ccm_statusBarItemButton=function(){this.css="",this.innerbuttonleft="",this.innerbuttonright="",this.label="",this.action="",this.url="",this.attribs=new Array,this.setLabel=function(e){this.label=e},this.setCSSClass=function(e){this.css=e},this.setInnerButtonLeftHTML=function(e){this.innerbuttonleft=e},this.setInnerButtonRightHTML=function(e){this.innerbuttonright=e},this.setAction=function(e){this.action=e},this.getAttributes=function(){return this.attribs},this.addAttribute=function(e,t){this.attribs.push({key:e,value:t})},this.getAction=function(){return this.action},this.setURL=function(e){this.url=e},this.getURL=function(){return this.url},this.getCSSClass=function(){return this.css},this.getInnerButtonLeftHTML=function(){return this.innerbuttonleft},this.getInnerButtonRightHTML=function(){return this.innerbuttonright},this.getLabel=function(){return this.label}},ccm_activateTabBar=function(t){$("#ccm-tab-content-"+t.find("li[class=active] a").attr("data-tab")).show(),t.find("a").unbind().click(function(){t.find("li").removeClass("active"),$(this).parent().addClass("active"),t.find("a").each(function(){$("#ccm-tab-content-"+$(this).attr("data-tab")).hide()});var e=$(this).attr("data-tab");return $("#ccm-tab-content-"+e).show(),!1})};var ccm_editorCurrentAuxTool=!1,ccm_arrangeMode=(ccm_editorSetupImagePicker=function(){tinyMCE.activeEditor.focus();var c=tinyMCE.activeEditor.selection.getBookmark();return!(ccm_chooseAsset=function(e){var t=tinyMCE.activeEditor,i=(t.selection.moveToBookmark(c),{});tinymce.extend(i,{src:e.filePathInline,alt:e.title,width:e.width,height:e.height}),t.execCommand("mceInsertContent",!1,'<img id="__mce_tmp" src="javascript:;" />',{skip_undo:1}),t.dom.setAttribs("__mce_tmp",i),t.dom.setAttrib("__mce_tmp","id",""),t.undoManager.add()})},ccm_editorSetupFilePicker=function(){tinyMCE.activeEditor.focus();var i=tinyMCE.activeEditor.selection.getBookmark();return!(ccm_chooseAsset=function(e){var t=tinyMCE.activeEditor;t.selection.moveToBookmark(i),""!=t.selection.getContent()?t.execCommand("mceInsertLink",!1,{href:e.filePath,title:e.title,target:null,class:"file ext-"+e.filePathDirect.split(".").pop()}):(t='<a href="'+e.filePath+'" class="file ext-'+e.filePathDirect.split(".").pop()+'">'+e.title+"</a>",tinyMCE.execCommand("mceInsertRawHTML",!1,t,!0))})},ccm_editorSitemapOverlay=function(){tinyMCE.activeEditor.focus();var s=tinyMCE.activeEditor.selection.getBookmark();$.fn.dialog.open({title:ccmi18n_sitemap.choosePage,href:CCM_TOOLS_PATH+"/sitemap_search_selector.php?sitemap_select_mode=select_page&callback=ccm_editorSelectSitemapNode",width:"90%",modal:!1,height:"70%"}),ccm_editorSelectSitemapNode=function(e,t){var i=tinyMCE.activeEditor,c=(i.selection.moveToBookmark(s),i.selection.getContent()),a=CCM_BASE_URL+CCM_DISPATCHER_FILENAME+"?cID="+e;""!=c?i.execCommand("mceInsertLink",!1,{href:a,title:t,target:null,class:null}):(c='<a href="'+CCM_BASE_URL+CCM_DISPATCHER_FILENAME+"?cID="+e+'" title="'+t+'">'+t+"</a>",tinyMCE.execCommand("mceInsertRawHTML",!1,c,!0))}},!1),ccm_selectedDomID=!1,ccm_isBlockError=!1,ccm_activeMenu=!1,ccm_blockError=!1,ccmCustomStyle=(ccm_menuInit=function(t){if(CCM_EDIT_MODE&&!CCM_ARRANGE_MODE)switch(t.type){case"BLOCK":$("#b"+t.bID+"-"+t.aID).mouseover(function(e){ccm_activate(t,"#b"+t.bID+"-"+t.aID)});break;case"AREA":$("#a"+t.aID+"controls").mouseover(function(e){ccm_activate(t,"#a"+t.aID+"controls")})}},ccm_showBlockMenu=function(e,t){ccm_hideMenus(),t.stopPropagation(),ccm_activeMenu=!0;var i,c=document.getElementById("ccm-block-menu"+e.bID+"-"+e.aID);c?c=$("#ccm-block-menu"+e.bID+"-"+e.aID):((el=document.createElement("DIV")).id="ccm-block-menu"+e.bID+"-"+e.aID,el.className="ccm-menu ccm-ui",el.style.display="block",el.style.visibility="hidden",document.body.appendChild(el),(c=$("#ccm-block-menu"+e.bID+"-"+e.aID)).css("position","absolute"),i='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">',i+="<ul>",e.canWrite&&e.hasEditDialog&&(i+=e.editInline?'<li><a class="ccm-menu-icon ccm-icon-edit-menu" onclick="ccm_hideMenus()" id="menuEdit'+e.bID+"-"+e.aID+'" href="'+CCM_DISPATCHER_FILENAME+"?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+"&btask=edit#_edit"+e.bID+'">'+ccmi18n.editBlock+"</a></li>":'<li><a class="ccm-menu-icon ccm-icon-edit-menu" onclick="ccm_hideMenus()" dialog-title="'+ccmi18n.editBlockWithName.replace(/%s/g,e.btName)+'" dialog-append-buttons="true" dialog-modal="false" dialog-on-close="ccm_blockWindowAfterClose()" dialog-width="'+e.width+'" dialog-height="'+e.height+'" id="menuEdit'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=edit">'+ccmi18n.editBlock+"</a></li>"),e.canWriteStack&&(i=i+('<li><a class="ccm-menu-icon ccm-icon-edit-menu" id="menuEdit'+e.bID+"-"+e.aID+'" href="'+CCM_DISPATCHER_FILENAME+"/dashboard/blocks/stacks/-/view_details/"+e.stID+'">'+ccmi18n.editStackContents)+'</a></li><li class="header"></li>'),e.canCopyToScrapbook&&(i+='<li><a class="ccm-menu-icon ccm-icon-clipboard-menu" id="menuAddToScrapbook'+e.bID+"-"+e.aID+'" href="#" onclick="javascript:ccm_addToScrapbook('+e.cID+","+e.bID+",'"+encodeURIComponent(e.arHandle)+"');return false;\">"+ccmi18n.copyBlockToScrapbook+"</a></li>"),e.canArrange&&(i+='<li><a class="ccm-menu-icon ccm-icon-move-menu" id="menuArrange'+e.bID+"-"+e.aID+'" href="javascript:ccm_arrangeInit()">'+ccmi18n.arrangeBlock+"</a></li>"),e.canDelete&&(i+='<li><a class="ccm-menu-icon ccm-icon-delete-menu" id="menuDelete'+e.bID+"-"+e.aID+'" href="#" onclick="javascript:ccm_deleteBlock('+e.cID+","+e.bID+","+e.aID+", '"+encodeURIComponent(e.arHandle)+"', '"+e.deleteMessage+"');return false;\">"+ccmi18n.deleteBlock+"</a></li>"),(e.canDesign||e.canEditBlockCustomTemplate)&&(i+='<li class="ccm-menu-separator"></li>'),e.canDesign&&(i+='<li><a class="ccm-menu-icon ccm-icon-design-menu" onclick="ccm_hideMenus()" dialog-modal="false" dialog-title="'+ccmi18n.changeBlockBaseStyle+'" dialog-width="475" dialog-height="500" dialog-append-buttons="true" id="menuChangeCSS'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=block_css&modal=true&width=300&height=100" title="'+ccmi18n.changeBlockCSS+'">'+ccmi18n.changeBlockCSS+"</a></li>"),e.canEditBlockCustomTemplate&&(i+='<li><a class="ccm-menu-icon ccm-icon-custom-template-menu" onclick="ccm_hideMenus()" dialog-append-buttons="true" dialog-modal="false" dialog-title="'+ccmi18n.changeBlockTemplate+'" dialog-width="300" dialog-height="275" id="menuChangeTemplate'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=template&modal=true&width=300&height=275" title="'+ccmi18n.changeBlockTemplate+'">'+ccmi18n.changeBlockTemplate+"</a></li>"),(e.canModifyGroups||e.canScheduleGuestAccess||e.canAliasBlockOut||e.canSetupComposer)&&(i+='<li class="ccm-menu-separator"></li>'),e.canModifyGroups&&(i+='<li><a title="'+ccmi18n.setBlockPermissions+'" onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-permissions-menu" dialog-width="420" dialog-height="350" id="menuBlockGroups'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=groups" dialog-append-buttons="true" dialog-title="'+ccmi18n.setBlockPermissions+'">'+ccmi18n.setBlockPermissions+"</a></li>"),e.canScheduleGuestAccess&&(i+='<li><a title="'+ccmi18n.scheduleGuestAccess+'" onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-clock-menu" dialog-width="500" dialog-height="220" id="menuBlockViewClock'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=guest_timed_access" dialog-append-buttons="true" dialog-title="'+ccmi18n.scheduleGuestAccess+'">'+ccmi18n.scheduleGuestAccess+"</a></li>"),e.canAliasBlockOut&&(i+='<li><a class="ccm-menu-icon ccm-icon-setup-child-pages-menu" dialog-append-buttons="true" onclick="ccm_hideMenus()" dialog-width="550" dialog-height="450" id="menuBlockAliasOut'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=child_pages" dialog-title="'+ccmi18n.setBlockAlias+'">'+ccmi18n.setBlockAlias+"</a></li>"),e.canSetupComposer&&(i+='<li><a class="ccm-menu-icon ccm-icon-setup-composer-menu" dialog-append-buttons="true" onclick="ccm_hideMenus()" dialog-width="450" dialog-modal="false" dialog-height="130" id="menuBlockSetupComposer'+e.bID+"-"+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_block_popup.php?cID="+e.cID+"&bID="+e.bID+"&arHandle="+encodeURIComponent(e.arHandle)+'&btask=composer" dialog-title="'+ccmi18n.setBlockComposerSettings+'">'+ccmi18n.setBlockComposerSettings+"</a></li>"),c.append(i=i+"</ul>"+"</div></div></div>"),e.canWrite&&!e.editInline&&$("a#menuEdit"+e.bID+"-"+e.aID).dialog(),e.canEditBlockCustomTemplate&&$("a#menuChangeTemplate"+e.bID+"-"+e.aID).dialog(),e.canDesign&&$("a#menuChangeCSS"+e.bID+"-"+e.aID).dialog(),e.canAliasBlockOut&&$("a#menuBlockAliasOut"+e.bID+"-"+e.aID).dialog(),e.canSetupComposer&&$("a#menuBlockSetupComposer"+e.bID+"-"+e.aID).dialog(),e.canModifyGroups&&$("#menuBlockGroups"+e.bID+"-"+e.aID).dialog(),e.canScheduleGuestAccess&&$("#menuBlockViewClock"+e.bID+"-"+e.aID).dialog()),ccm_fadeInMenu(c,t)},ccm_reloadAreaMenuPermissions=function(e,t){e=window["ccm_areaMenuObj"+e];e&&(t=CCM_TOOLS_PATH+"/reload_area_permissions_js.php?arHandle="+e.arHandle+"&cID="+t+"&maximumBlocks="+e.maximumBlocks,$.getScript(t))},ccm_openAreaAddBlock=function(e,t,i){t=t||0,i=i||CCM_CID,$.fn.dialog.open({title:ccmi18n.blockAreaMenu,href:CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+i+"&atask=add&arHandle="+e+"&addOnly="+t,width:550,modal:!1,height:380})},ccm_showAreaMenu=function(e,t){var i,c,a=e.addOnly?1:0;ccm_activeMenu=!0,t.shiftKey?ccm_openAreaAddBlock(e.arHandle,a):(t.stopPropagation(),(i=document.getElementById("ccm-area-menu"+e.aID))?i=$("#ccm-area-menu"+e.aID):((el=document.createElement("DIV")).id="ccm-area-menu"+e.aID,el.className="ccm-menu ccm-ui",el.style.display="block",el.style.visibility="hidden",document.body.appendChild(el),(i=$("#ccm-area-menu"+e.aID)).css("position","absolute"),c='<div class="popover"><div class="arrow"></div><div class="inner"><div class="content">',c+="<ul>",e.canAddBlocks&&(c=(c+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-add-block-menu" dialog-title="'+ccmi18n.addBlockNew+'" dialog-modal="false" dialog-width="550" dialog-height="380" id="menuAddNewBlock'+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(e.arHandle)+"&atask=add&addOnly="+a+'">'+ccmi18n.addBlockNew+"</a></li>")+'<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-clipboard-menu" dialog-title="'+ccmi18n.addBlockPaste+'" dialog-modal="false" dialog-width="550" dialog-height="380" id="menuAddPaste'+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(e.arHandle)+"&atask=paste&addOnly="+a+'">'+ccmi18n.addBlockPaste+"</a></li>"),e.canAddStacks&&(c+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-add-stack-menu" dialog-title="'+ccmi18n.addBlockStack+'" dialog-modal="false" dialog-width="550" dialog-height="380" id="menuAddNewStack'+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(e.arHandle)+"&atask=add_from_stack&addOnly="+a+'">'+ccmi18n.addBlockStack+"</a></li>"),e.canAddBlocks&&(e.canDesign||e.canLayout)&&(c+='<li class="ccm-menu-separator"></li>'),e.canLayout&&(c+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-add-layout-menu" dialog-title="'+ccmi18n.addAreaLayout+'" dialog-modal="false" dialog-width="400" dialog-height="300" dialog-append-buttons="true" id="menuAreaLayout'+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(e.arHandle)+'&atask=layout">'+ccmi18n.addAreaLayout+"</a></li>"),e.canDesign&&(c+='<li><a onclick="ccm_hideMenus()" class="ccm-menu-icon ccm-icon-design-menu" dialog-title="'+ccmi18n.changeAreaCSS+'" dialog-modal="false" dialog-append-buttons="true" dialog-width="475" dialog-height="500" id="menuAreaStyle'+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(e.arHandle)+'&atask=design">'+ccmi18n.changeAreaCSS+"</a></li>"),e.canWrite&&e.canModifyGroups&&(c+='<li class="ccm-menu-separator"></li>'),e.canModifyGroups&&(c+='<li><a onclick="ccm_hideMenus()" title="'+ccmi18n.setAreaPermissions+'" dialog-append-buttons="true" dialog-modal="false" class="ccm-menu-icon ccm-icon-permissions-menu" dialog-width="420" dialog-height="425" id="menuAreaGroups'+e.aID+'" href="'+CCM_TOOLS_PATH+"/edit_area_popup.php?cID="+CCM_CID+"&arHandle="+encodeURIComponent(e.arHandle)+'&atask=groups" dialog-title="'+ccmi18n.setAreaPermissions+'">'+ccmi18n.setAreaPermissions+"</a></li>"),i.append(c=c+"</ul>"+"</div></div></div>"),e.canAddBlocks&&($("a#menuAddNewBlock"+e.aID).dialog(),$("a#menuAddPaste"+e.aID).dialog()),e.canAddStacks&&$("a#menuAddNewStack"+e.aID).dialog(),e.canLayout&&$("a#menuAreaLayout"+e.aID).dialog(),e.canDesign&&$("a#menuAreaStyle"+e.aID).dialog(),e.canModifyGroups&&$("a#menuAreaGroups"+e.aID).dialog()),ccm_fadeInMenu(i,t))},ccm_hideHighlighter=function(){$("#ccm-highlighter").css("display","none"),$("div.ccm-menu-hotspot-active").removeClass("ccm-menu-hotspot-active")},ccm_addError=function(e){ccm_isBlockError||(ccm_blockError="",ccm_blockError+="<ul>"),ccm_isBlockError=!0,ccm_blockError+="<li>"+e+"</li>"},ccm_resetBlockErrors=function(){ccm_isBlockError=!1,ccm_blockError=""},ccm_addToScrapbook=function(e,t,i){ccm_mainNavDisableDirectExit(),ccm_hideHighlighter(),$.ajax({type:"POST",url:CCM_TOOLS_PATH+"/pile_manager.php",data:"cID="+e+"&bID="+t+"&arHandle="+i+"&btask=add&scrapbookName=userScrapbook",success:function(e){ccm_hideHighlighter(),ccmAlert.hud(ccmi18n.copyBlockToScrapbookMsg,2e3,"add",ccmi18n.copyBlockToScrapbook)}})},ccm_deleteBlock=function(e,t,i,c,a){confirm(a)&&(ccm_mainNavDisableDirectExit(),ccm_hideHighlighter(),($d=$("#b"+t+"-"+i)).hide(),ccmAlert.hud(ccmi18n.deleteBlockMsg,2e3,"delete_small",ccmi18n.deleteBlock),$.ajax({type:"POST",url:CCM_DISPATCHER_FILENAME,data:"cID="+e+"&ccm_token="+CCM_SECURITY_TOKEN+"&isAjax=true&btask=remove&bID="+t+"&arHandle="+c}),ccm_reloadAreaMenuPermissions(i,e),"function"==typeof window.ccm_parseBlockResponsePost)&&ccm_parseBlockResponsePost({})},ccm_hideMenus=function(){ccm_activeMenu=!1,$("div.ccm-menu").hide(),$("div.ccm-menu").css("visibility","hidden"),$("div.ccm-menu").show()},ccm_parseBlockResponse=function(r,currentBlockID,task){try{if(r=r.replace(/(<([^>]+)>)/gi,""),resp=eval("("+r+")"),1==resp.error){var message="<ul>";for(i=0;i<resp.response.length;i++)message+="<li>"+resp.response[i]+"</li>";message+="</ul>",ccmAlert.notice(ccmi18n.error,message)}else{ccm_blockWindowClose(),cID=resp.cID||CCM_CID;var action=CCM_TOOLS_PATH+"/edit_block_popup?cID="+cID+"&bID="+resp.bID+"&arHandle="+encodeURIComponent(resp.arHandle)+"&btask=view_edit_mode";$.get(action,function(e){"add"==task?(0<$("#a"+resp.aID+" div.ccm-area-styles-a"+resp.aID).length?$("#a"+resp.aID+" div.ccm-area-styles-a"+resp.aID):$("#a"+resp.aID)).append(e):$("#b"+currentBlockID+"-"+resp.aID).before(e).remove(),jQuery.fn.dialog.hideLoader(),ccm_mainNavDisableDirectExit(),"add"==task?(ccmAlert.hud(ccmi18n.addBlockMsg,2e3,"add",ccmi18n.addBlock),jQuery.fn.dialog.closeAll()):ccmAlert.hud(ccmi18n.updateBlockMsg,2e3,"success",ccmi18n.updateBlock),"function"==typeof window.ccm_parseBlockResponsePost&&ccm_parseBlockResponsePost(resp)}),ccm_reloadAreaMenuPermissions(resp.aID,cID)}}catch(e){ccmAlert.notice(ccmi18n.error,r)}},ccm_mainNavDisableDirectExit=function(e){$("#ccm-exit-edit-mode-direct").hide(),e||$("#ccm-exit-edit-mode-comment").show()},ccm_setupBlockForm=function(e,t,i){e.ajaxForm({type:"POST",iframe:!0,beforeSubmit:function(){return ccm_hideHighlighter(),$("input[name=ccm-block-form-method]").val("AJAX"),jQuery.fn.dialog.showLoader(),ccm_blockFormSubmit()},success:function(e){ccm_parseBlockResponse(e,t,i)}})},ccm_activate=function(t,e){if(ccm_arrangeMode||ccm_activeMenu)return!1;ccm_selectedDomID&&$(ccm_selectedDomID).removeClass("ccm-menu-hotspot-active"),(aobj=$(e)).addClass("ccm-menu-hotspot-active"),ccm_selectedDomID=e,offs=aobj.offset(),$("#ccm-highlighter").hide(),$("#ccm-highlighter").css("width",aobj.outerWidth()),$("#ccm-highlighter").css("height",aobj.outerHeight()),$("#ccm-highlighter").css("top",offs.top),$("#ccm-highlighter").css("left",offs.left),$("#ccm-highlighter").fadeIn(120,"easeOutExpo"),$("#ccm-highlighter").mouseout(function(e){ccm_activeMenu||e.target&&0!=$(e.toElement).parents("div.ccm-menu").length||ccm_hideHighlighter()}),$("#ccm-highlighter").unbind("click"),$("#ccm-highlighter").click(function(e){switch(t.type){case"BLOCK":ccm_showBlockMenu(t,e);break;case"AREA":ccm_showAreaMenu(t,e)}})},ccm_editInit=function(){document.write=function(){},$(document.body).append('<div style="position: absolute; display:none" id="ccm-highlighter">&nbsp;</div>'),$(document).click(function(){ccm_hideMenus()}),$("div.ccm-menu a").bind("click.hide-menu",function(e){return ccm_hideMenus(),!1})},ccm_triggerSelectUser=function(e,t,i){alert(e),alert(t),alert(i)},ccm_setupUserSearch=function(e){$(".chosen-select").chosen(ccmi18n_chosen),$("#ccm-user-list-cb-all").click(function(){1==$(this).prop("checked")?($(".ccm-list-record td.ccm-user-list-cb input[type=checkbox]").attr("checked",!0),$("#ccm-user-list-multiple-operations").attr("disabled",!1)):($(".ccm-list-record td.ccm-user-list-cb input[type=checkbox]").attr("checked",!1),$("#ccm-user-list-multiple-operations").attr("disabled",!0))}),$("td.ccm-user-list-cb input[type=checkbox]").click(function(e){0<$("td.ccm-user-list-cb input[type=checkbox]:checked").length?$("#ccm-user-list-multiple-operations").attr("disabled",!1):$("#ccm-user-list-multiple-operations").attr("disabled",!0)}),$("#ccm-user-list-multiple-operations").change(function(){switch($(this).val()){case"choose":$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){ccm_triggerSelectUser($(this).val(),$(this).attr("user-name"),$(this).attr("user-email"))}),jQuery.fn.dialog.closeTop();break;case"properties":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_properties?"+uIDstring,title:ccmi18n.properties});break;case"activate":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_activate?searchInstance="+e+"&"+uIDstring,title:ccmi18n.user_activate});break;case"deactivate":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_deactivate?searchInstance="+e+"&"+uIDstring,title:ccmi18n.user_deactivate});break;case"group_add":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_group_add?searchInstance="+e+"&"+uIDstring,title:ccmi18n.user_group_add});break;case"group_remove":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_group_remove?searchInstance="+e+"&"+uIDstring,title:ccmi18n.user_group_remove});break;case"delete":uIDstring="",$("td.ccm-user-list-cb input[type=checkbox]:checked").each(function(){uIDstring=uIDstring+"&uID[]="+$(this).val()}),jQuery.fn.dialog.open({width:630,height:450,modal:!1,href:CCM_TOOLS_PATH+"/users/bulk_delete?searchInstance="+e+"&"+uIDstring,title:ccmi18n.user_delete})}$(this).get(0).selectedIndex=0})},ccm_triggerSelectGroup=function(e,t){alert(e),alert(t)},ccm_setupGroupSearchPaging=function(){$("div#ccm-group-paging").each(function(){$(this).closest(".ui-dialog-content").dialog("option","buttons",[{}]),$(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ccm-pane-dialog-pagination").remove(),$(this).appendTo($(this).closest(".ui-dialog").find(".ui-dialog-buttonpane").addClass("ccm-ui"))})},ccm_setupGroupSearch=function(e){$("div.ccm-group a").unbind(),func=e?window[e]:ccm_triggerSelectGroup,$("div.ccm-group a").each(function(e){var t=$(this);$(this).click(function(){return func(t.attr("group-id"),t.attr("group-name")),$.fn.dialog.closeTop(),!1})}),$("#ccm-group-search").ajaxForm({beforeSubmit:function(){$("#ccm-group-search-wrapper").html("")},success:function(e){$("#ccm-group-search-wrapper").html(e)}}),ccm_setupGroupSearchPaging(),$("div#ccm-group-paging a").click(function(){return $("#ccm-group-search-wrapper").html(""),$.ajax({type:"GET",url:$(this).attr("href"),success:function(e){$("#ccm-group-search-wrapper").html(e)}}),!1})},ccm_saveArrangement=function(e,t,c,a){e=e||CCM_CID;var t=t.attr("id").substring(1,t.attr("id").indexOf("-")),s=c.attr("id").substring(1),n=a.attr("id").substring(1),o=(ccm_mainNavDisableDirectExit(),"&sourceBlockID="+t+"&sourceBlockAreaID="+s+"&destinationBlockAreaID="+n),t=[c];s!=n&&t.push(a),$.each(t,function(e,t){for(areaStr="&area["+t.attr("id").substring(1)+"][]=",bArray=t.sortable("toArray"),i=0;i<bArray.length;i++){var c,a;""!=bArray[i]&&"b"==bArray[i].substring(0,1)&&(c=$("#"+bArray[i])).closest("div.ccm-area")[0]==t[0]&&(a=bArray[i].substring(1,bArray[i].indexOf("-")),c.attr("custom-style")&&(a+="-"+c.attr("custom-style")),o+=areaStr+a)}}),$.ajax({type:"POST",url:CCM_DISPATCHER_FILENAME,dataType:"json",data:"cID="+e+"&ccm_token="+CCM_SECURITY_TOKEN+"&btask=ajax_do_arrange"+o,success:function(e){ccm_parseJSON(e,function(){$("div.ccm-area").removeClass("ccm-move-mode"),$("div.ccm-block-arrange").each(function(){$(this).addClass("ccm-block"),$(this).removeClass("ccm-block-arrange")}),ccm_arrangeMode=!1,$(".ccm-main-nav-edit-option").fadeIn(300),ccmAlert.hud(ccmi18n.arrangeBlockMsg,2e3,"up_down",ccmi18n.arrangeBlock)})}})},ccm_arrangeInit=function(){ccm_arrangeMode=!0,ccm_hideHighlighter(),$("div.ccm-block").each(function(){$(this).addClass("ccm-block-arrange"),$(this).removeClass("ccm-block")}),$(".ccm-main-nav-edit-option").fadeOut(300,function(){$(".ccm-main-nav-arrange-option").fadeIn(300)}),$("div.ccm-area").each(function(){var a=$(this),s=a.attr("cID");a.addClass("ccm-move-mode"),a.sortable({items:"div.ccm-block-arrange",connectWith:$("div.ccm-area-move-enabled"),accept:"div.ccm-block-arrange",opacity:.5,stop:function(e,t){var i=a,c=t.item.closest(".ccm-area");ccm_saveArrangement(s,t.item,i,c)}})})},"function"!=typeof ccm_selectSitemapNode&&(ccm_selectSitemapNode=function(e,t){alert(e),alert(t)}),ccm_goToSitemapNode=function(e,t){window.location.href=CCM_DISPATCHER_FILENAME+"?cID="+e},ccm_fadeInMenu=function(e,t){var i=e.find("div.popover div.inner").width(),c=e.find("div.popover").height(),a=(e.hide(),e.css("visibility","visible"),t.pageX+2),s=t.pageY+2;$(window).height()<t.clientY+c?(s=s-c-10,a-=i/2,e.find("div.popover").removeClass("below"),e.find("div.popover").addClass("above")):(a-=i/2,s+=10,e.find("div.popover").removeClass("above"),e.find("div.popover").addClass("below")),e.css("top",s+"px"),e.css("left",a+"px"),e.fadeIn(60)},ccm_blockWindowClose=function(){jQuery.fn.dialog.closeTop(),ccm_blockWindowAfterClose()},ccm_blockWindowAfterClose=function(){ccmValidateBlockForm=function(){return!0}},ccm_blockFormSubmit=function(){return"function"!=typeof window.ccmValidateBlockForm||(r=window.ccmValidateBlockForm(),!ccm_isBlockError)||(jQuery.fn.dialog.hideLoader(),ccm_blockError&&ccmAlert.notice(ccmi18n.error,ccm_blockError+"</ul>"),ccm_resetBlockErrors(),!1)},ccm_paneToggleOptions=function(e){var t=$(e).parent().find("div.ccm-pane-options-content");$(e).hasClass("ccm-icon-option-closed")?($(e).removeClass("ccm-icon-option-closed").addClass("ccm-icon-option-open"),t.slideDown("fast","easeOutExpo")):($(e).removeClass("ccm-icon-option-open").addClass("ccm-icon-option-closed"),t.slideUp("fast","easeOutExpo"))},ccm_setupGridStriping=function(e){$("#"+e+" tr").removeClass();var t=0;$("#"+e+" tr").each(function(){"none"!=$(this).css("display")&&(t%2==0&&$(this).addClass("ccm-row-alt"),t++)})},ccm_t=function(e){return $("input[name=ccm-string-"+e+"]").val()},{tabs:function(e,t){return $(".ccm-styleEditPane").hide(),$("#ccm-styleEditPane-"+t).show(),$(e.parentNode.parentNode).find("li").removeClass("ccm-nav-active"),$(e.parentNode).addClass("ccm-nav-active"),!1},resetAll:function(){return!!confirm(ccmi18n.confirmCssReset)&&(jQuery.fn.dialog.showLoader(),$("#ccm-reset-style").val(1),$("#ccmCustomCssForm").get(0).submit(),!0)},showPresetDeleteIcon:function(){0<$("select[name=cspID]").val()?$("#ccm-style-delete-preset").show():$("#ccm-style-delete-preset").hide()},deletePreset:function(){var e=$("select[name=cspID]").val();if(0<e){if(!confirm(ccmi18n.confirmCssPresetDelete))return!1;e=$("#ccm-custom-style-refresh-action").val()+"&deleteCspID="+e+"&subtask=delete_custom_style_preset";jQuery.fn.dialog.showLoader(),$.get(e,function(e){$("#ccm-custom-style-wrapper").html(e),jQuery.fn.dialog.hideLoader()})}},initForm:function(){0<$("#cspFooterPreset").length&&$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select, #ccmCustomCssFormTabs textarea").bind("change click",function(){$("#cspFooterPreset").show(),$("#cspFooterNoPreset").remove(),$("#ccmCustomCssFormTabs input, #ccmCustomCssFormTabs select").unbind("change click")}),$("input[name=cspPresetAction]").click(function(){"create_new_preset"==$(this).val()&&$(this).prop("checked")?$("input[name=cspName]").attr("disabled",!1).focus():$("input[name=cspName]").val("").attr("disabled",!0)}),ccmCustomStyle.showPresetDeleteIcon(),ccmCustomStyle.lastPresetID=parseInt($("select[name=cspID]").val()),$("select[name=cspID]").change(function(){var e=parseInt($(this).val()),t=parseInt($("input[name=selectedCsrID]").val());if(ccmCustomStyle.lastPresetID==e)return!1;ccmCustomStyle.lastPresetID=e,jQuery.fn.dialog.showLoader(),e=0<e?$("#ccm-custom-style-refresh-action").val()+"&cspID="+e:$("#ccm-custom-style-refresh-action").val()+"&csrID="+t,$.get(e,function(e){$("#ccm-custom-style-wrapper").html(e),jQuery.fn.dialog.hideLoader()})}),$("#ccmCustomCssForm").submit(function(){return 1==$("input[name=cspCreateNew]").prop("checked")&&""==$("input[name=cspName]").val()?($("input[name=cspName]").focus(),alert(ccmi18n.errorCustomStylePresetNoName),!1):(jQuery.fn.dialog.showLoader(),!0)}),parseInt(ccmCustomStyle.lastPresetID)||setTimeout(function(){$("#ccmCustomCssFormTabs input").attr("disabled",!1).get(0).focus()},500)},validIdCheck:function(e,t){e=$("#"+e.value);e&&e.get(0)&&e.get(0).id!=t?$("#ccm-styles-invalid-id").css("display","block"):$("#ccm-styles-invalid-id").css("display","none")}}),ccm_hideToolbarMenusTimer=($(function(){0<$("#ccm-toolbar").length&&(ccm_intelligentSearchActivateResults(),ccm_intelligentSearchDoRemoteCalls($("#ccm-nav-intelligent-search").val()))}),ccm_togglePopover=function(e,t){$(".popover").is(":visible")?$(t).popover("hide"):($(t).popover("show"),e.stopPropagation(),$(window).bind("click.popover",function(){$(t).popover("hide"),$(window).unbind("click.popover")}))},ccm_toggleQuickNav=function(e,t){var i=$("#ccm-add-to-quick-nav"),c=(i.hasClass("ccm-icon-favorite-selected")?i.removeClass("ccm-icon-favorite-selected").addClass("ccm-icon-favorite"):i.removeClass("ccm-icon-favorite").addClass("ccm-icon-favorite-selected"),$("#ccm-nav-dashboard")),i=i.parent().parent().parent().find("h3");i.css("display","inline"),i.effect("transfer",{to:c,easing:"easeOutExpo"},600),$.get(CCM_TOOLS_PATH+"/dashboard/add_to_quick_nav",{cID:e,token:t},function(e){e=$("<div />").html(e);$("#ccm-intelligent-search-results").html(e.find("#ccm-intelligent-search-results").html()),$("#ccm-dashboard-overlay").html(e.find("#ccm-dashboard-overlay").html()),$("#ccm-nav-intelligent-search").data("liveUpdate").setupCache()})},!1),ajaxtimer=(ccm_hideToolbarMenus=function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$("#ccm-edit-overlay").fadeOut(90,"easeOutExpo"),$("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo"),clearTimeout(ccm_hideToolbarMenusTimer)},ccm_activateToolbar=function(){$("#ccm-dashboard-overlay").css("visibility","visible").hide(),$("#ccm-nav-intelligent-search-wrapper").click(function(){$("#ccm-nav-intelligent-search").focus()}),$("#ccm-nav-intelligent-search").focus(function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$(this).parent().addClass("ccm-system-nav-selected"),$("#ccm-dashboard-overlay").is(":visible")&&($("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo"),$(window).unbind("click.dashboard-nav"))}),$(".ccm-nav-edit-mode-active").click(function(){return!1}),$("#ccm-edit-overlay,#ccm-dashboard-overlay").mouseover(function(){clearTimeout(ccm_hideToolbarMenusTimer)}),$("#ccm-nav-dashboard").hoverIntent(function(){return clearTimeout(ccm_hideToolbarMenusTimer),$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$(this).parent().addClass("ccm-system-nav-selected"),$("#ccm-nav-intelligent-search").val(""),$("#ccm-intelligent-search-results").fadeOut(90,"easeOutExpo"),$("#ccm-edit-overlay").is(":visible")&&($("#ccm-edit-overlay").fadeOut(90,"easeOutExpo"),$(window).unbind("click.ccm-edit")),$("#ccm-dashboard-overlay").fadeIn(160,"easeOutExpo"),$(window).bind("click.dashboard-nav",function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo"),$(window).unbind("click.dashboard-nav")}),!1},function(){}),$("#ccm-nav-dashboard,#ccm-dashboard-overlay,#ccm-nav-edit,#ccm-edit-overlay").mouseout(function(){ccm_hideToolbarMenusTimer=setTimeout(function(){ccm_hideToolbarMenus()},1500)}),$("#ccm-nav-intelligent-search").bind("keydown.ccm-intelligent-search",function(i){var e,c,a;13!=i.keyCode&&40!=i.keyCode&&38!=i.keyCode||(i.preventDefault(),i.stopPropagation(),13==i.keyCode&&0<$("a.ccm-intelligent-search-result-selected").length&&((e=$("a.ccm-intelligent-search-result-selected").attr("href"))&&"#"!=e&&"javascript:void(0)"!=e?window.location.href=e:$("a.ccm-intelligent-search-result-selected").click()),c=$("#ccm-intelligent-search-results li:visible"),40!=i.keyCode&&38!=i.keyCode)||($.each(c,function(e,t){$(t).children("a").hasClass("ccm-intelligent-search-result-selected")&&(io=38==i.keyCode?c[e-1]:c[e+1],a=$(io).find("a"))}),a&&0<a.length&&($("a.ccm-intelligent-search-result-selected").removeClass(),$(a).addClass("ccm-intelligent-search-result-selected")))}),$("#ccm-nav-intelligent-search").bind("keyup.ccm-intelligent-search",function(e){ccm_intelligentSearchDoRemoteCalls($(this).val())}),$("#ccm-nav-intelligent-search").blur(function(){$(this).parent().removeClass("ccm-system-nav-selected")}),$("#ccm-nav-intelligent-search").liveUpdate("ccm-intelligent-search-results","intelligent-search"),$("#ccm-nav-intelligent-search").bind("click",function(e){""==this.value&&$("#ccm-intelligent-search-results").hide()}),$("#ccm-toolbar-nav-properties").dialog(),$("#ccm-toolbar-nav-preview-as-user").dialog(),$("#ccm-toolbar-add-subpage").dialog(),$("#ccm-toolbar-nav-versions").dialog(),$("#ccm-toolbar-nav-design").dialog(),$("#ccm-toolbar-nav-permissions").dialog(),$("#ccm-toolbar-nav-speed-settings").dialog(),$("#ccm-toolbar-nav-move-copy").dialog(),$("#ccm-toolbar-nav-delete").dialog(),$("#ccm-edit-overlay,#ccm-dashboard-overlay").click(function(e){e.stopPropagation()}),$("#ccm-nav-edit").hoverIntent(function(){clearTimeout(ccm_hideToolbarMenusTimer),$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$(this).parent().addClass("ccm-system-nav-selected"),$("#ccm-nav-intelligent-search").val(""),$("#ccm-intelligent-search-results").fadeOut(90,"easeOutExpo"),$("#ccm-dashboard-overlay").is(":visible")&&($("#ccm-dashboard-overlay").fadeOut(90,"easeOutExpo"),$(window).unbind("click.dashboard-nav")),setTimeout("$('#ccm-check-in-comments').focus();",300),$("#ccm-check-in-preview").click(function(){$("#ccm-approve-field").val("PREVIEW"),$("#ccm-check-in").submit()}),$("#ccm-check-in-discard").click(function(){$("#ccm-approve-field").val("DISCARD"),$("#ccm-check-in").submit()}),$("#ccm-check-in-publish").click(function(){$("#ccm-approve-field").val("APPROVE"),$("#ccm-check-in").submit()});var e=$(this).position().left;return 0<e&&(e-=20),$("#ccm-edit-overlay").css("left",e+"px"),$("#ccm-edit-overlay").fadeIn(160,"easeOutExpo",function(){$(this).find("a").click(function(){ccm_toolbarCloseEditMenu()})}),$(window).bind("click.ccm-edit",function(){ccm_toolbarCloseEditMenu()}),!1},function(){})},null),ajaxquery=null;function ccm_previewInternalTheme(e,t,i){var c=$("input[name=ctID]").val();$.fn.dialog.open({title:i,href:CCM_TOOLS_PATH+"/themes/preview?themeID="+t+"&previewCID="+e+"&ctID="+c,width:"85%",modal:!1,height:"75%"})}function ccm_previewMarketplaceTheme(e,t,i,c){var a=$("input[name=ctID]").val();$.fn.dialog.open({title:i,href:CCM_TOOLS_PATH+"/themes/preview?themeCID="+t+"&previewCID="+e+"&themeHandle="+encodeURIComponent(c)+"&ctID="+a,width:"85%",modal:!1,height:"75%"})}function ccm_previewComposerDraft(e,t){$.fn.dialog.open({title:t,href:CCM_TOOLS_PATH+"/composer/preview_frame?previewCID="+e,width:"85%",modal:!1,height:"75%"})}ccm_toolbarCloseEditMenu=function(){$(".ccm-system-nav-selected").removeClass("ccm-system-nav-selected"),$("#ccm-edit-overlay").fadeOut(90,"easeOutExpo"),$(window).unbind("click.ccm-edit")},ccm_intelligentSearchActivateResults=function(){0==$("#ccm-intelligent-search-results div:visible").length&&$("#ccm-intelligent-search-results").hide(),$("#ccm-intelligent-search-results a").hover(function(){$("a.ccm-intelligent-search-result-selected").removeClass(),$(this).addClass("ccm-intelligent-search-result-selected")},function(){$(this).removeClass("ccm-intelligent-search-result-selected")})},ccm_intelligentSearchDoRemoteCalls=function(e){(e=jQuery.trim(e))&&2<e.length&&e!=ajaxquery&&(ajaxtimer&&window.clearTimeout(ajaxtimer),ajaxquery=e,ajaxtimer=window.setTimeout(function(){ajaxtimer=null,$("#ccm-intelligent-search-results-list-marketplace").parent().show(),$("#ccm-intelligent-search-results-list-help").parent().show(),$("#ccm-intelligent-search-results-list-your-site").parent().show(),$("#ccm-intelligent-search-results-list-marketplace").parent().addClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-help").parent().addClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-your-site").parent().addClass("ccm-intelligent-search-results-module-loading"),$.getJSON(CCM_TOOLS_PATH+"/marketplace/intelligent_search",{q:ajaxquery},function(e){for($("#ccm-intelligent-search-results-list-marketplace").parent().removeClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-marketplace").html(""),i=0;i<e.length;i++){var t=e[i],c="ccm_getMarketplaceItemDetails("+t.mpID+")";$("#ccm-intelligent-search-results-list-marketplace").append('<li><a href="javascript:void(0)" onclick="'+c+'"><img src="'+t.img+'" />'+t.name+"</a></li>")}0==e.length&&$("#ccm-intelligent-search-results-list-marketplace").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),ccm_intelligentSearchActivateResults()}).error(function(){$("#ccm-intelligent-search-results-list-marketplace").parent().hide()}),$.getJSON(CCM_TOOLS_PATH+"/get_remote_help",{q:ajaxquery},function(e){for($("#ccm-intelligent-search-results-list-help").parent().removeClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-help").html(""),i=0;i<e.length;i++){var t=e[i];$("#ccm-intelligent-search-results-list-help").append('<li><a href="'+t.href+'">'+t.name+"</a></li>")}0==e.length&&$("#ccm-intelligent-search-results-list-help").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),ccm_intelligentSearchActivateResults()}).error(function(){$("#ccm-intelligent-search-results-list-help").parent().hide()}),$.getJSON(CCM_TOOLS_PATH+"/pages/intelligent_search",{q:ajaxquery},function(e){for($("#ccm-intelligent-search-results-list-your-site").parent().removeClass("ccm-intelligent-search-results-module-loading"),$("#ccm-intelligent-search-results-list-your-site").html(""),i=0;i<e.length;i++){var t=e[i];$("#ccm-intelligent-search-results-list-your-site").append('<li><a href="'+t.href+'">'+t.name+"</a></li>")}0==e.length&&$("#ccm-intelligent-search-results-list-your-site").parent().hide(),0==$(".ccm-intelligent-search-result-selected").length&&($("#ccm-intelligent-search-results").find("li a").removeClass("ccm-intelligent-search-result-selected"),$("#ccm-intelligent-search-results li:visible a:first").addClass("ccm-intelligent-search-result-selected")),ccm_intelligentSearchActivateResults()}).error(function(){$("#ccm-intelligent-search-results-list-your-site").parent().hide()})},500))},ccm_marketplaceDetailShowMore=function(){$(".ccm-marketplace-item-information-more").hide(),$(".ccm-marketplace-item-information-inner").css("max-height","none")},ccm_marketplaceUpdatesShowMore=function(e){$(e).parent().hide(),$(e).parent().parent().find(".ccm-marketplace-update-changelog").css("max-height","none")},ccm_enableDesignScrollers=function(){$("a.ccm-scroller-l").hover(function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_l_active.png")},function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_l.png")}),$("a.ccm-scroller-r").hover(function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_r_active.png")},function(){$(this).find("img").attr("src",CCM_IMAGE_PATH+"/button_scroller_r.png")});$("a.ccm-scroller-r").unbind("click"),$("a.ccm-scroller-l").unbind("click"),$("a.ccm-scroller-r").click(function(){var e=$(this).parent().children("div.ccm-scroller-inner").children("ul"),t=$(this).parent().attr("current-page"),i=$(this).parent().attr("current-pos"),c=$(this).parent().attr("num-pages"),i=parseInt(i)-528;t++,$(this).parent().attr("current-page",t),$(this).parent().attr("current-pos",i),t==c&&$(this).hide(),1<t&&$(this).siblings("a.ccm-scroller-l").show(),$(e).css("left",i+"px")}),$("a.ccm-scroller-l").click(function(){var e=$(this).parent().children("div.ccm-scroller-inner").children("ul"),t=$(this).parent().attr("current-page"),i=$(this).parent().attr("current-pos"),c=$(this).parent().attr("num-pages"),i=parseInt(i)+528;t--,$(this).parent().attr("current-page",t),$(this).parent().attr("current-pos",i),1==t&&$(this).hide(),t<c&&$(this).siblings("a.ccm-scroller-r").show(),$(e).css("left",i+"px")}),$("a.ccm-scroller-l").hide(),$("a.ccm-scroller-r").each(function(){1==parseInt($(this).parent().attr("num-pages"))&&$(this).hide()}),$("#ccm-select-page-type a").click(function(){$("#ccm-select-page-type li").each(function(){$(this).removeClass("ccm-item-selected")}),$(this).parent().addClass("ccm-item-selected"),$("input[name=ctID]").val($(this).attr("ccm-page-type-id"))}),$("#ccm-select-theme a").click(function(){$("#ccm-select-theme li").each(function(){$(this).removeClass("ccm-item-selected")}),$(this).parent().addClass("ccm-item-selected"),$("input[name=plID]").val($(this).attr("ccm-theme-id"))})};
//# sourceMappingURL=ccm.app.js.map